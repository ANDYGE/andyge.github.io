<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"swiftist.cn","root":"/","scheme":"Pisces","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"EVBR3H53HW","apiKey":"2abd573a01143a0cc4108fa4d21ae67c","indexName":"swiftist","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="勇于积极进取，步入人生的世外桃源">
<meta property="og:type" content="website">
<meta property="og:title" content="飞雪轩辕">
<meta property="og:url" content="https://swiftist.cn/page/57/index.html">
<meta property="og:site_name" content="飞雪轩辕">
<meta property="og:description" content="勇于积极进取，步入人生的世外桃源">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Andy Ge">
<meta property="article:tag" content="技术博客">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://swiftist.cn/page/57/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>飞雪轩辕</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="飞雪轩辕" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">飞雪轩辕</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">人生的乐趣在于把梦想变成现实</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-java">

    <a href="/categories/java/" rel="section"><i class="fa fa-fw fa-th-large"></i>java</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/10/git/git%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%85%A8%E5%B1%80%E5%BF%AB%E6%8D%B7%E5%91%BD%E4%BB%A4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/10/git/git%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%85%A8%E5%B1%80%E5%BF%AB%E6%8D%B7%E5%91%BD%E4%BB%A4/" class="post-title-link" itemprop="url">git自动提交全局快捷命令</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-10 07:55:32" itemprop="dateCreated datePublished" datetime="2018-11-10T07:55:32+08:00">2018-11-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/git/" itemprop="url" rel="index">
                    <span itemprop="name">git</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/10/git/git%E8%87%AA%E5%8A%A8%E6%8F%90%E4%BA%A4%E5%85%A8%E5%B1%80%E5%BF%AB%E6%8D%B7%E5%91%BD%E4%BB%A4/" class="post-meta-item leancloud_visitors" data-flag-title="git自动提交全局快捷命令" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1. 介绍"></a>1. 介绍</h1><p>在任何仓库目录下，执行该命令自动提交更新并 pull 最新代码</p>
<h2 id="1-1-创建提交命令文件s"><a href="#1-1-创建提交命令文件s" class="headerlink" title="1.1. 创建提交命令文件s"></a>1.1. 创建提交命令文件<code>s</code></h2><h3 id="1-1-1-mac-linux"><a href="#1-1-1-mac-linux" class="headerlink" title="1.1.1. mac/linux"></a>1.1.1. mac/linux</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提交文件名称为s</span></span><br><span class="line">touch /usr/<span class="built_in">local</span>/bin/s</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加执行权限</span></span><br><span class="line">chmod +x /usr/<span class="built_in">local</span>/bin/s</span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-windows"><a href="#1-1-2-windows" class="headerlink" title="1.1.2. windows"></a>1.1.2. windows</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前的环境变量</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># 可以看到当前的全局路径中包含/c/Users/AndyGe/bin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看/c/Users/AndyGe下是否包含bin目录</span></span><br><span class="line">ls /c/Users/Andyge</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果不包含的话，则创建</span></span><br><span class="line">mkdir /c/Users/AndyGe/bin</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建s文件，用作提交命令</span></span><br><span class="line">touch /c/Users/AndyGe/bin/s</span><br></pre></td></tr></table></figure>

<h3 id="1-1-3-s文件内容"><a href="#1-1-3-s文件内容" class="headerlink" title="1.1.3. s文件内容"></a>1.1.3. <code>s</code>文件内容</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#使用方法：不加任何参数，默认注释为"update"，后面可以跟一个注释参数，如果注释参数包含空格，则需要用双引号括起来.</span></span><br><span class="line"><span class="comment"># s</span></span><br><span class="line"><span class="comment"># s optimize</span></span><br><span class="line"><span class="comment"># s "optimize code"</span></span><br><span class="line"></span><br><span class="line">comment=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! <span class="variable">$comment</span> ]; <span class="keyword">then</span></span><br><span class="line">comment=<span class="string">"update"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">git add . &amp;&amp; git c -m <span class="string">"<span class="variable">$comment</span>"</span> &amp;&amp; git pull origin master &amp;&amp; git push</span><br></pre></td></tr></table></figure>

<h2 id="1-2-自动提交到当前分支"><a href="#1-2-自动提交到当前分支" class="headerlink" title="1.2. 自动提交到当前分支"></a>1.2. 自动提交到当前分支</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment">#使用方法：不加任何参数，默认注释为"update"，后面可以跟一个注释参数，如果注释参数包含空格，则需要用双引号括起来.</span></span><br><span class="line"><span class="comment">#./.s</span></span><br><span class="line"><span class="comment">#./.s optimize</span></span><br><span class="line"><span class="comment">#./.s "optimize code"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">comment=<span class="variable">$1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ ! <span class="variable">$comment</span> ]; <span class="keyword">then</span></span><br><span class="line">comment=<span class="string">"update"</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">branch=`git branch | awk  <span class="string">'$1 == "*"&#123;print $2&#125;'</span>`</span><br><span class="line"></span><br><span class="line">git add . &amp;&amp; git c -m <span class="string">"<span class="variable">$comment</span>"</span> &amp;&amp; git pull origin <span class="variable">$branch</span> &amp;&amp; git push -u origin <span class="variable">$branch</span></span><br></pre></td></tr></table></figure>

<h2 id="1-3-执行命令"><a href="#1-3-执行命令" class="headerlink" title="1.3. 执行命令"></a>1.3. 执行命令</h2><p>转到任何 git 仓库的根目录下，执行<code>s</code>即可。如果当前目录不是 git 仓库，则会提示<code>fatal: Not a git repository (or any of the parent directories): .git</code>，如：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转到git仓库所在的工作目录下</span></span><br><span class="line"><span class="built_in">cd</span> /root/workspace/myproject</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交更新，commit注释为'XXXX'</span></span><br><span class="line">s <span class="string">'add XXXX'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以直接执行，commit注释会默认为'update'</span></span><br><span class="line">s</span><br></pre></td></tr></table></figure>

<h2 id="1-4-注意事项"><a href="#1-4-注意事项" class="headerlink" title="1.4. 注意事项"></a>1.4. 注意事项</h2><ul>
<li><code>s</code>文件要放置在<code>$PATH</code>目录下，建议放置在<code>/usr/local/bin</code>下，这样在任何位置都可以直接执行<code>s</code>命令了。</li>
<li>执行命令的文件下，要包含<code>.git</code>文件夹，即<code>git</code>仓库数据，也就是<code>git</code>仓库的根目录。</li>
<li>也可以将<code>s</code>文件夹放置在当前仓库的根目录下，然后在当前目录下执行<code>./s</code>即可。</li>
</ul>
<h1 id="2-同步扩展"><a href="#2-同步扩展" class="headerlink" title="2. 同步扩展"></a>2. 同步扩展</h1><h2 id="2-1-拉取单个仓库最新版本p"><a href="#2-1-拉取单个仓库最新版本p" class="headerlink" title="2.1. 拉取单个仓库最新版本p"></a>2.1. 拉取单个仓库最新版本<code>p</code></h2><p>在上述的 PATH 目录下创建一个文件<code>p</code>，内容如下，同时添加执行权限，这样就可以在任意仓库下直接输入<code>p</code>命令就可以获取最新版本。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin master</span><br></pre></td></tr></table></figure>

<h2 id="2-2-获取多个仓库最新版本pa"><a href="#2-2-获取多个仓库最新版本pa" class="headerlink" title="2.2. 获取多个仓库最新版本pa"></a>2.2. 获取多个仓库最新版本<code>pa</code></h2><p>如果开发中涉及到多个仓库，可以创建一个批处理命令，这样每次再开机时，执行一下<code>pa</code>就可以同步这些仓库到最新。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/Desktop/OWL/Server</span><br><span class="line">p</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/OWL/WXApp</span><br><span class="line">p</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/OWL/Web</span><br><span class="line">p</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/OWL/File</span><br><span class="line">p</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/OWL/Tools</span><br><span class="line">p</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/OWL/Private</span><br><span class="line">p</span><br><span class="line"><span class="built_in">cd</span> ~/Desktop/Blogs</span><br><span class="line">p</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/09/SpringJPA/Spring-Data-Jpa-%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/09/SpringJPA/Spring-Data-Jpa-%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">Spring Data Jpa --- 入门</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-09 16:17:57" itemprop="dateCreated datePublished" datetime="2018-11-09T16:17:57+08:00">2018-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/09/SpringJPA/Spring-Data-Jpa-%E5%85%A5%E9%97%A8/" class="post-meta-item leancloud_visitors" data-flag-title="Spring Data Jpa --- 入门" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-概述"><a href="#1-概述" class="headerlink" title="1. 概述"></a>1. 概述</h1><p>Spring Data 是 Spring 下的一个子项目，用于简化数据库访问，并支持云服务的开源框架。Spring Data 支持 NoSQL 和 关系数据存储，其主要目标是使得数据库的访问变得方便快捷。并支持 map-reduce 框架和云计算数据服务。对于拥有海量数据的项目，可以用 Spring Data 来简化项目的开发。 然而针对不同的数据储存访问使用相对的类库来操作访问。Spring<br>Data 中已经为我们提供了很多业务中常用的一些接口和实现类来帮我们快速构建项目，比如分页、排序、DAO 一些常用的操作。</p>
<h1 id="2-环境搭建"><a href="#2-环境搭建" class="headerlink" title="2. 环境搭建"></a>2. 环境搭建</h1><h2 id="2-1-导入-jar-包"><a href="#2-1-导入-jar-包" class="headerlink" title="2.1. 导入 jar 包"></a>2.1. 导入 jar 包</h2><p><img src="/images/java/20180122165138679.png" alt=""></p>
<h2 id="2-2-applicationContext-xml-配置"><a href="#2-2-applicationContext-xml-配置" class="headerlink" title="2.2. applicationContext.xml 配置"></a>2.2. applicationContext.xml 配置</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:tx</span>=<span class="string">"http://www.springframework.org/schema/tx"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:jpa</span>=<span class="string">"http://www.springframework.org/schema/data/jpa"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/data/jpa http://www.springframework.org/schema/data/jpa/spring-jpa-1.3.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-4.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 配置自动扫描的包 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.test.springdata"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 1. 配置数据源 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:config.properties"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClass"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jdbcUrl"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"user"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.user&#125;"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 2. 配置 JPA 的 EntityManagerFactory --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"entityManagerFactory"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jpaVendorAdapter"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"packagesToScan"</span> <span class="attr">value</span>=<span class="string">"com.test.springdata"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"jpaProperties"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- 二级缓存相关 --&gt;</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">&lt;!-- &lt;prop key="hibernate.cache.region.factory_class"&gt;org.hibernate.cache.ehcache.EhCacheRegionFactory&lt;/prop&gt;</span></span><br><span class="line"><span class="comment">				&lt;prop key="net.sf.ehcache.configurationResourceName"&gt;ehcache-hibernate.xml&lt;/prop&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">				<span class="comment">&lt;!-- 生成的数据表的列的映射策略 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.ejb.naming_strategy"</span>&gt;</span>org.hibernate.cfg.ImprovedNamingStrategy<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="comment">&lt;!-- hibernate 基本属性 --&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.dialect"</span>&gt;</span>org.hibernate.dialect.Oracle10gDialect<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.show_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.format_sql"</span>&gt;</span>true<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"hibernate.hbm2ddl.auto"</span>&gt;</span>update<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 3. 配置事务管理器 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">class</span>=<span class="string">"org.springframework.orm.jpa.JpaTransactionManager"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"entityManagerFactory"</span> <span class="attr">ref</span>=<span class="string">"entityManagerFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 4. 配置支持注解的事务 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 5. 配置 SpringData --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 加入  jpa 的命名空间 --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- base-package: 扫描 Repository Bean 所在的 package --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">jpa:repositories</span> <span class="attr">base-package</span>=<span class="string">"com.test.springdata"</span></span></span><br><span class="line"><span class="tag">		<span class="attr">entity-manager-factory-ref</span>=<span class="string">"entityManagerFactory"</span>&gt;</span><span class="tag">&lt;/<span class="name">jpa:repositories</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="3-Repository-接口"><a href="#3-Repository-接口" class="headerlink" title="3. Repository 接口"></a>3. Repository 接口</h1><p><code>Repository</code> 接口是 <code>Spring Data</code> 的一个核心接口，它不提供任何方法，开发者需要在自己定义的接口中声明需要的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Repository</span>&lt;<span class="title">T</span>, <span class="title">ID</span> <span class="keyword">extends</span> <span class="title">Serializable</span>&gt; </span>&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>说明：</p>
<ul>
<li>Repository 是一个空接口，即是一个标记接口</li>
<li>若我们定义的接口继承了 Repository，则该接口会被 IOC 容器识别为一个 Repository Bean 注入到 IOC 容器中，只要遵循<strong>Spring Data 的方法定义规范</strong>，就无需写实现类。</li>
<li>与继承 Repository 等价的一种方式，就是在持久层接口上使用 @RepositoryDefinition 注解，并为其指定<strong>domainClass</strong> 和 <strong>idClass 属性</strong>。如下两种方式是完全等价的</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RepositoryDefinition</span>(domainClass=Person<span class="class">.<span class="keyword">class</span>,<span class="title">idClass</span></span>=Integer<span class="class">.<span class="keyword">class</span>)</span></span><br></pre></td></tr></table></figure>

<h2 id="3-1-Repository-的子接口"><a href="#3-1-Repository-的子接口" class="headerlink" title="3.1. Repository 的子接口"></a>3.1. Repository 的子接口</h2><p>基础的 Repository 提供了最基本的数据访问功能，其几个子接口则扩展了一些功能。它们的继承关系如下：</p>
<ul>
<li><strong>Repository</strong>： 仅仅是一个标识，表明任何继承它的均为仓库接口类</li>
<li><strong>CrudRepository</strong>： 继承 <strong>Repository</strong>，实现了一组 CRUD 相关的方法</li>
<li><strong>PagingAndSortingRepository</strong>： 继承<br><strong>CrudRepository</strong>，实现了一组分页排序相关的方法</li>
<li><strong>JpaRepository</strong>： 继承 <strong>PagingAndSortingRepository</strong>，实现一组 JPA 规范相关的方法</li>
</ul>
<p><img src="../../images/java/20180122195235936.png" alt=""></p>
<h2 id="3-2-Spring-Data-方法定义规范"><a href="#3-2-Spring-Data-方法定义规范" class="headerlink" title="3.2. Spring Data 方法定义规范"></a>3.2. Spring Data 方法定义规范</h2><p>查询方法以 find | read | get 开头，设计条件查询时，条件的属性用条件关键字连接，要注意的是：条件属性以首字母大写。</p>
<p>例如：定义一个 Entity 实体类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span>｛</span></span><br><span class="line"><span class="class">     <span class="title">private</span> <span class="title">String</span> <span class="title">firstName</span></span>;</span><br><span class="line">     <span class="keyword">private</span> String lastName;</span><br><span class="line">｝</span><br></pre></td></tr></table></figure>

<p>使用 And 条件连接时，应这样写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">findByLastNameAndFirstName(String lastName,String firstName);</span><br></pre></td></tr></table></figure>

<p>条件的属性名称与个数要与参数的位置与个数一一对应</p>
<p>直接在接口中定义查询方法，如果是符合规范的，可以不用写实现，目前支持的关键字写法如下： <img src="../../images/java/20180122194225617.png" alt=""></p>
<p><img src="../../images/java/20180122194235862.png" alt=""></p>
<h1 id="4-CrudRepository-接口"><a href="#4-CrudRepository-接口" class="headerlink" title="4. CrudRepository 接口"></a>4. CrudRepository 接口</h1><p>CrudRepository 接口提供了最基本的对实体类的添删改查操作</p>
<ul>
<li>T save(T entity);//保存单个实体</li>
<li>Iterable<T> save(Iterable&lt;? extends T&gt; entities);//保存集合</li>
<li>T findOne(ID id);//根据 id 查找实体</li>
<li>boolean exists(ID id);//根据 id 判断实体是否存在</li>
<li>Iterable<T> findAll();//查询所有实体,不用或慎用!</li>
<li>long count();//查询实体数量</li>
<li>void delete(ID id);//根据 Id 删除实体</li>
<li>void delete(T entity);//删除一个实体</li>
<li>void delete(Iterable&lt;? extends T&gt; entities);//删除一个实体的集合</li>
<li>void deleteAll();//删除所有实体,不用或慎用!</li>
</ul>
<h1 id="5-PagingAndSortingRepository-接口"><a href="#5-PagingAndSortingRepository-接口" class="headerlink" title="5. PagingAndSortingRepository 接口"></a>5. PagingAndSortingRepository 接口</h1><p>PagingAndSortingRepository 接口提供了分页与排序的功能：</p>
<ul>
<li>Iterable<T> findAll(Sort sort); //排序</li>
<li>Page<T> findAll(Pageable pageable); //分页查询（含排序功能）</li>
</ul>
<h1 id="6-JpaRepository-接口"><a href="#6-JpaRepository-接口" class="headerlink" title="6. JpaRepository 接口"></a>6. JpaRepository 接口</h1><p>JpaRepository 接口提供了 JPA 的相关功能：</p>
<ul>
<li>List<T> findAll(); //查找所有实体</li>
<li>List<T> findAll(Sort sort); //排序、查找所有实体</li>
<li>List<T> save(Iterable&lt;? extends T&gt; entities);//保存集合</li>
<li>void flush();//执行缓存与数据库同步</li>
<li>T saveAndFlush(T entity);//强制执行持久化</li>
<li>void deleteInBatch(Iterable<T> entities);//删除一个实体集合</li>
</ul>
<h1 id="7-示例代码"><a href="#7-示例代码" class="headerlink" title="7. 示例代码"></a>7. 示例代码</h1><p><strong>Person 实体类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Column;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.JoinColumn;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.ManyToOne;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"JPA_PERSONS"</span>)</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String lastName;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String email;</span><br><span class="line">	<span class="keyword">private</span> Date birth;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Address address;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer addressId;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> lastName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastName</span><span class="params">(String lastName)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.lastName = lastName;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEmail</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> email;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEmail</span><span class="params">(String email)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.email = email;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">getBirth</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> birth;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setBirth</span><span class="params">(Date birth)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.birth = birth;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Column</span>(name=<span class="string">"ADD_ID"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAddressId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> addressId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddressId</span><span class="params">(Integer addressId)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.addressId = addressId;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@JoinColumn</span>(name=<span class="string">"ADDRESS_ID"</span>)</span><br><span class="line">	<span class="meta">@ManyToOne</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Address <span class="title">getAddress</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> address;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAddress</span><span class="params">(Address address)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.address = address;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Person [id="</span> + id + <span class="string">", lastName="</span> + lastName + <span class="string">", email="</span></span><br><span class="line">				+ email + <span class="string">", brith="</span> + birth + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Address 实体类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.Entity;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.GeneratedValue;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Id;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.Table;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Table</span>(name=<span class="string">"JPA_ADDRESSES"</span>)</span><br><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Integer id;</span><br><span class="line">	<span class="keyword">private</span> String province;</span><br><span class="line">	<span class="keyword">private</span> String city;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@GeneratedValue</span></span><br><span class="line">	<span class="meta">@Id</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.id = id;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getProvince</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> province;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProvince</span><span class="params">(String province)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.province = province;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getCity</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> city;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCity</span><span class="params">(String city)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.city = city;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>JpaRepsotory 类 — PersonRepsotory 类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.JpaSpecificationExecutor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.Modifying;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.repository.Query;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.CrudRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.PagingAndSortingRepository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.RepositoryDefinition;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.repository.query.Param;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1、Repository 是一个空接口，即使一个标记接口</span></span><br><span class="line"><span class="comment"> * 2、若我们定义的接口继承了Repository，则该接口会被IOC容器识别为一个Repository Bean</span></span><br><span class="line"><span class="comment"> * 纳入到IOC容器中，进而可以在该接口中定义满足一定规范的方法</span></span><br><span class="line"><span class="comment"> * 3、可以通过注解的方式标记Repository接口</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方式一：继承Repository&lt;Person,Integer&gt;接口</span></span><br><span class="line"><span class="comment"> * public interface PersonRepsotory extends Repository&lt;Person,Integer&gt;&#123;</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 方式二：注解<span class="doctag">@RepositoryDefinition</span>(domainClass=Person.class,idClass=Integer.class)</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 在Repository子接口中声明方法</span></span><br><span class="line"><span class="comment"> * 1、不是随便声明的，而需要符合一定的规范</span></span><br><span class="line"><span class="comment"> * 2、查询方法以find | read | get开头</span></span><br><span class="line"><span class="comment"> * 3、涉及条件查询时，条件的属性用条件关键字连接</span></span><br><span class="line"><span class="comment"> * 4、要注意的是：条件属性以首字母大写</span></span><br><span class="line"><span class="comment"> * 5、支持属性的级联查询，若当前类有符合条件的属性，则优先使用，而不使用级联属性。若需要使用级联属性，则属性之间使用_连接</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// @RepositoryDefinition(domainClass=Person.class,idClass=Integer.class)</span></span><br><span class="line"><span class="comment">//public interface PersonRepsotory extends Repository&lt;Person, Integer&gt;&#123;</span></span><br><span class="line"><span class="comment">//public interface PersonRepsotory extends CrudRepository&lt;Person, Integer&gt;&#123;</span></span><br><span class="line"><span class="comment">//public interface PersonRepsotory extends JpaRepository&lt;Person, Integer&gt;,JpaSpecificationExecutor&lt;Person&gt;&#123;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PersonRepsotory</span> <span class="keyword">extends</span> <span class="title">Repository</span>&lt;<span class="title">Person</span>, <span class="title">Integer</span>&gt;</span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据lastName来获取对应的Person</span></span><br><span class="line">	<span class="function">Person <span class="title">getByLastName</span><span class="params">(String lastName)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Where lastName like ?% And id &lt; ?</span></span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">getByLastNameStartingWithAndIdLessThan</span><span class="params">(String lastName, Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Where lastName like %? And id &lt; ?</span></span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">getByLastNameEndingWithAndIdLessThan</span><span class="params">(String lastName, Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//WHERE email IN (?, ?, ?) OR birth &lt; ?</span></span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">getByEmailInAndBirthLessThan</span><span class="params">(List&lt;String&gt; emails, Date birth)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//WHERE a.id &gt; ?</span></span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">getByAddress_IdGreaterThan</span><span class="params">(Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//查询 id 值最大的那个 Person</span></span><br><span class="line">	<span class="comment">//使用 @Query 注解可以自定义 JPQL 语句以实现更灵活的查询</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"SELECT p FROM Person p WHERE p.id = (SELECT max(p2.id) FROM Person p2)"</span>)</span><br><span class="line">	<span class="function">Person <span class="title">getMaxIdPerson</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//为 @Query 注解传递参数的方式1: 使用占位符.</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"SELECT p FROM Person p WHERE p.lastName = ?1 AND p.email = ?2"</span>)</span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">testQueryAnnotationParams1</span><span class="params">(String lastName, String email)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//为 @Query 注解传递参数的方式1: 命名参数的方式.</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"SELECT p FROM Person p WHERE p.lastName = :lastName AND p.email = :email"</span>)</span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">testQueryAnnotationParams2</span><span class="params">(@Param(<span class="string">"email"</span>)</span> String email, @<span class="title">Param</span><span class="params">(<span class="string">"lastName"</span>)</span> String lastName)</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//SpringData 允许在占位符上添加 %%.</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"SELECT p FROM Person p WHERE p.lastName LIKE %?1% OR p.email LIKE %?2%"</span>)</span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">testQueryAnnotationLikeParam</span><span class="params">(String lastName, String email)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//SpringData 允许在占位符上添加 %%.</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"SELECT p FROM Person p WHERE p.lastName LIKE %:lastName% OR p.email LIKE %:email%"</span>)</span><br><span class="line">	<span class="function">List&lt;Person&gt; <span class="title">testQueryAnnotationLikeParam2</span><span class="params">(@Param(<span class="string">"email"</span>)</span> String email, @<span class="title">Param</span><span class="params">(<span class="string">"lastName"</span>)</span> String lastName)</span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//设置 nativeQuery=true 即可以使用原生的 SQL 查询</span></span><br><span class="line">	<span class="meta">@Query</span>(value=<span class="string">"SELECT count(id) FROM jpa_persons"</span>, nativeQuery=<span class="keyword">true</span>)</span><br><span class="line">	<span class="function"><span class="keyword">long</span> <span class="title">getTotalCount</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//可以通过自定义的 JPQL 完成 UPDATE 和 DELETE 操作. 注意: JPQL 不支持使用 INSERT</span></span><br><span class="line">	<span class="comment">//在 @Query 注解中编写 JPQL 语句, 但必须使用 @Modifying 进行修饰. 以通知 SpringData, 这是一个 UPDATE 或 DELETE 操作</span></span><br><span class="line">	<span class="comment">//UPDATE 或 DELETE 操作需要使用事务, 此时需要定义 Service 层. 在 Service 层的方法上添加事务操作.</span></span><br><span class="line">	<span class="comment">//默认情况下, SpringData 的每个方法上有事务, 但都是一个只读事务. 他们不能完成修改操作!</span></span><br><span class="line">	<span class="meta">@Modifying</span></span><br><span class="line">	<span class="meta">@Query</span>(<span class="string">"UPDATE Person p SET p.email = :email WHERE id = :id"</span>)</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updatePersonEmail</span><span class="params">(@Param(<span class="string">"id"</span>)</span> Integer id, @<span class="title">Param</span><span class="params">(<span class="string">"email"</span>)</span> String email)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>PersonService 类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="keyword">private</span> PersonRepsotory personRepsotory;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">savePersons</span><span class="params">(List&lt;Person&gt; persons)</span></span>&#123;</span><br><span class="line">		personRepsotory.save(persons);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Transactional</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updatePersonEmail</span><span class="params">(String email, Integer id)</span></span>&#123;</span><br><span class="line">		personRepsotory.updatePersonEmail(id, email);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Test 类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.FileNotFoundException;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.criteria.CriteriaBuilder;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.criteria.CriteriaQuery;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.criteria.Path;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.criteria.Predicate;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.criteria.Root;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Page;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.PageRequest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort.Direction;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.domain.Sort.Order;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.jpa.domain.Specification;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.test.springdata.Person;</span><br><span class="line"><span class="keyword">import</span> com.test.springdata.PersonRepsotory;</span><br><span class="line"><span class="keyword">import</span> com.test.springdata.PersonService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringDataTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> ApplicationContext ctx = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> PersonRepsotory personRepsotory = <span class="keyword">null</span>;</span><br><span class="line">	<span class="keyword">private</span> PersonService personService;</span><br><span class="line"></span><br><span class="line">	&#123;</span><br><span class="line">		ctx = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"applicationContext.xml"</span>);</span><br><span class="line">		personRepsotory = ctx.getBean(PersonRepsotory<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		personService = ctx.getBean(PersonService<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/*@Test</span></span><br><span class="line"><span class="comment">	public void testCommonCustomRepositoryMethod()&#123;</span></span><br><span class="line"><span class="comment">		ApplicationContext ctx2 = new ClassPathXmlApplicationContext("classpath:com/atguigu/springdata/commonrepositorymethod/applicationContext2.xml");</span></span><br><span class="line"><span class="comment">		AddressRepository addressRepository = ctx2.getBean(AddressRepository.class);</span></span><br><span class="line"><span class="comment">		addressRepository.method();</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	@Test</span></span><br><span class="line"><span class="comment">	public void testCustomRepositoryMethod()&#123;</span></span><br><span class="line"><span class="comment">		personRepsotory.test();</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 目标: 实现带查询条件的分页. id &gt; 5 的条件</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * 调用 JpaSpecificationExecutor 的 Page&lt;T&gt; findAll(Specification&lt;T&gt; spec, Pageable pageable);</span></span><br><span class="line"><span class="comment">	 * Specification: 封装了 JPA Criteria 查询的查询条件</span></span><br><span class="line"><span class="comment">	 * Pageable: 封装了请求分页的信息: 例如 pageNo, pageSize, Sort</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="comment">/*@Test</span></span><br><span class="line"><span class="comment">	public void testJpaSpecificationExecutor()&#123;</span></span><br><span class="line"><span class="comment">		int pageNo = 3 - 1;</span></span><br><span class="line"><span class="comment">		int pageSize = 5;</span></span><br><span class="line"><span class="comment">		PageRequest pageable = new PageRequest(pageNo, pageSize);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		//通常使用 Specification 的匿名内部类</span></span><br><span class="line"><span class="comment">		Specification&lt;Person&gt; specification = new Specification&lt;Person&gt;() &#123;</span></span><br><span class="line"><span class="comment">			*/</span><span class="comment">/**</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@param</span> *root: 代表查询的实体类.</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@param</span> query: 可以从中可到 Root 对象, 即告知 JPA Criteria 查询要查询哪一个实体类. 还可以</span></span><br><span class="line"><span class="comment">			 * 来添加查询条件, 还可以结合 EntityManager 对象得到最终查询的 TypedQuery 对象.</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@param</span> *cb: CriteriaBuilder 对象. 用于创建 Criteria 相关对象的工厂. 当然可以从中获取到 Predicate 对象</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@return</span>: *Predicate 类型, 代表一个查询条件.</span></span><br><span class="line"><span class="comment">			 */</span><span class="comment">/*</span></span><br><span class="line"><span class="comment">			@Override</span></span><br><span class="line"><span class="comment">			public Predicate toPredicate(Root&lt;Person&gt; root,</span></span><br><span class="line"><span class="comment">					CriteriaQuery&lt;?&gt; query, CriteriaBuilder cb) &#123;</span></span><br><span class="line"><span class="comment">				Path path = root.get("id");</span></span><br><span class="line"><span class="comment">				Predicate predicate = cb.gt(path, 5);</span></span><br><span class="line"><span class="comment">				return predicate;</span></span><br><span class="line"><span class="comment">			&#125;</span></span><br><span class="line"><span class="comment">		&#125;;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		Page&lt;Person&gt; page = personRepsotory.findAll(specification, pageable);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		System.out.println("总记录数: " + page.getTotalElements());</span></span><br><span class="line"><span class="comment">		System.out.println("当前第几页: " + (page.getNumber() + 1));</span></span><br><span class="line"><span class="comment">		System.out.println("总页数: " + page.getTotalPages());</span></span><br><span class="line"><span class="comment">		System.out.println("当前页面的 List: " + page.getContent());</span></span><br><span class="line"><span class="comment">		System.out.println("当前页面的记录数: " + page.getNumberOfElements());</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*@Test</span></span><br><span class="line"><span class="comment">	public void testJpaRepository()&#123;</span></span><br><span class="line"><span class="comment">		Person person = new Person();</span></span><br><span class="line"><span class="comment">		person.setBirth(new Date());</span></span><br><span class="line"><span class="comment">		person.setEmail("xy@atguigu.com");</span></span><br><span class="line"><span class="comment">		person.setLastName("xyz");</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		Person person2 = personRepsotory.saveAndFlush(person);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		System.out.println(person == person2);</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">/*@Test</span></span><br><span class="line"><span class="comment">	public void testPagingAndSortingRespository()&#123;</span></span><br><span class="line"><span class="comment">		//pageNo 从 0 开始.</span></span><br><span class="line"><span class="comment">		int pageNo = 0;</span></span><br><span class="line"><span class="comment">		int pageSize = 5;</span></span><br><span class="line"><span class="comment">		//Pageable 接口通常使用的其 PageRequest 实现类. 其中封装了需要分页的信息</span></span><br><span class="line"><span class="comment">		//排序相关的. Sort 封装了排序的信息</span></span><br><span class="line"><span class="comment">		//Order 是具体针对于某一个属性进行升序还是降序.</span></span><br><span class="line"><span class="comment">		Order order1 = new Order(Direction.DESC, "id");</span></span><br><span class="line"><span class="comment">		Order order2 = new Order(Direction.ASC, "email");</span></span><br><span class="line"><span class="comment">		Sort sort = new Sort(order1, order2);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		PageRequest pageable = new PageRequest(pageNo, pageSize, sort);</span></span><br><span class="line"><span class="comment">		Page&lt;Person&gt; page = personRepsotory.findAll(pageable);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		System.out.println("总记录数: " + page.getTotalElements());</span></span><br><span class="line"><span class="comment">		System.out.println("当前第几页: " + (page.getNumber() + 1));</span></span><br><span class="line"><span class="comment">		System.out.println("总页数: " + page.getTotalPages());</span></span><br><span class="line"><span class="comment">		System.out.println("当前页面的 List: " + page.getContent());</span></span><br><span class="line"><span class="comment">		System.out.println("当前页面的记录数: " + page.getNumberOfElements());</span></span><br><span class="line"><span class="comment">	&#125;*/</span></span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCrudReposiory</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Person&gt; persons = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="string">'a'</span>; i &lt;= <span class="string">'z'</span>; i++)&#123;</span><br><span class="line">			Person person = <span class="keyword">new</span> Person();</span><br><span class="line">			person.setAddressId(i + <span class="number">1</span>);</span><br><span class="line">			person.setBirth(<span class="keyword">new</span> Date());</span><br><span class="line">			person.setEmail((<span class="keyword">char</span>)i + <span class="string">""</span> + (<span class="keyword">char</span>)i + <span class="string">"@atguigu.com"</span>);</span><br><span class="line">			person.setLastName((<span class="keyword">char</span>)i + <span class="string">""</span> + (<span class="keyword">char</span>)i);</span><br><span class="line"></span><br><span class="line">			persons.add(person);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		personService.savePersons(persons);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testModifying</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//		personRepsotory.updatePersonEmail(1, "mmmm@atguigu.com");</span></span><br><span class="line">		personService.updatePersonEmail(<span class="string">"mmmm@atguigu.com"</span>, <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testNativeQuery</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">long</span> count = personRepsotory.getTotalCount();</span><br><span class="line">		System.out.println(count);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAnnotationLikeParam</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="comment">//		List&lt;Person&gt; persons = personRepsotory.testQueryAnnotationLikeParam("%A%", "%bb%");</span></span><br><span class="line"><span class="comment">//		System.out.println(persons.size());</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//		List&lt;Person&gt; persons = personRepsotory.testQueryAnnotationLikeParam("A", "bb");</span></span><br><span class="line"><span class="comment">//		System.out.println(persons.size());</span></span><br><span class="line"></span><br><span class="line">		List&lt;Person&gt; persons = personRepsotory.testQueryAnnotationLikeParam2(<span class="string">"bb"</span>, <span class="string">"A"</span>);</span><br><span class="line">		System.out.println(persons.size());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAnnotationParams2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Person&gt; persons = personRepsotory.testQueryAnnotationParams2(<span class="string">"aa@atguigu.com"</span>, <span class="string">"AA"</span>);</span><br><span class="line">		System.out.println(persons);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAnnotationParams1</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Person&gt; persons = personRepsotory.testQueryAnnotationParams1(<span class="string">"AA"</span>, <span class="string">"aa@atguigu.com"</span>);</span><br><span class="line">		System.out.println(persons);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQueryAnnotation</span><span class="params">()</span></span>&#123;</span><br><span class="line">		Person person = personRepsotory.getMaxIdPerson();</span><br><span class="line">		System.out.println(person);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testKeyWords2</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Person&gt; persons = personRepsotory.getByAddress_IdGreaterThan(<span class="number">1</span>);</span><br><span class="line">		System.out.println(persons);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testKeyWords</span><span class="params">()</span></span>&#123;</span><br><span class="line">		List&lt;Person&gt; persons = personRepsotory.getByLastNameStartingWithAndIdLessThan(<span class="string">"X"</span>, <span class="number">10</span>);</span><br><span class="line">		System.out.println(persons);</span><br><span class="line"></span><br><span class="line">		persons = personRepsotory.getByLastNameEndingWithAndIdLessThan(<span class="string">"X"</span>, <span class="number">10</span>);</span><br><span class="line">		System.out.println(persons);</span><br><span class="line"></span><br><span class="line">		persons = personRepsotory.getByEmailInAndBirthLessThan(Arrays.asList(<span class="string">"AA@atguigu.com"</span>, <span class="string">"FF@atguigu.com"</span>,</span><br><span class="line">				<span class="string">"SS@atguigu.com"</span>), <span class="keyword">new</span> Date());</span><br><span class="line">		System.out.println(persons.size());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testHelloWorldSpringData</span><span class="params">()</span> <span class="keyword">throws</span> FileNotFoundException, IOException, InstantiationException, IllegalAccessException</span>&#123;</span><br><span class="line">		System.out.println(personRepsotory.getClass().getName());</span><br><span class="line"></span><br><span class="line">		Person person = personRepsotory.getByLastName(<span class="string">"AA"</span>);</span><br><span class="line">		System.out.println(person);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJpa</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDataSource</span><span class="params">()</span> <span class="keyword">throws</span> SQLException </span>&#123;</span><br><span class="line">		DataSource dataSource = ctx.getBean(DataSource<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		System.out.println(dataSource.getConnection());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="8-JpaSpecificationExecutor-接口"><a href="#8-JpaSpecificationExecutor-接口" class="headerlink" title="8. JpaSpecificationExecutor 接口"></a>8. JpaSpecificationExecutor 接口</h1><p>不属于 Repository 体系，实现一组 JPA Criteria 查询相关的方法<br><img src="../../images/java/20180122200412896.png" alt=""><br>Specification：封装 JPA Criteria 查询条件。</p>
<p>通常使用匿名内部类的方式来创建该接口的对象</p>
<p><strong>示例代码：</strong></p>
<p>Test 代码，其他代码参考 JpaRepository</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 目标: 实现带查询条件的分页. id &gt; 5 的条件</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * 调用 JpaSpecificationExecutor 的 Page&lt;T&gt; findAll(Specification&lt;T&gt; spec, Pageable pageable);</span></span><br><span class="line"><span class="comment">	 * Specification: 封装了 JPA Criteria 查询的查询条件</span></span><br><span class="line"><span class="comment">	 * Pageable: 封装了请求分页的信息: 例如 pageNo, pageSize, Sort</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJpaSpecificationExecutor</span><span class="params">()</span></span>&#123;</span><br><span class="line">		<span class="keyword">int</span> pageNo = <span class="number">3</span> - <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">int</span> pageSize = <span class="number">5</span>;</span><br><span class="line">		PageRequest pageable = <span class="keyword">new</span> PageRequest(pageNo, pageSize);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//通常使用 Specification 的匿名内部类</span></span><br><span class="line">		Specification&lt;Person&gt; specification = <span class="keyword">new</span> Specification&lt;Person&gt;() &#123;</span><br><span class="line">			<span class="comment">/**</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@param</span> *root: 代表查询的实体类.</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@param</span> query: 可以从中可到 Root 对象, 即告知 JPA Criteria 查询要查询哪一个实体类. 还可以</span></span><br><span class="line"><span class="comment">			 * 来添加查询条件, 还可以结合 EntityManager 对象得到最终查询的 TypedQuery 对象.</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@param</span> *cb: CriteriaBuilder 对象. 用于创建 Criteria 相关对象的工厂. 当然可以从中获取到 Predicate 对象</span></span><br><span class="line"><span class="comment">			 * <span class="doctag">@return</span>: *Predicate 类型, 代表一个查询条件.</span></span><br><span class="line"><span class="comment">			 */</span></span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> Predicate <span class="title">toPredicate</span><span class="params">(Root&lt;Person&gt; root,</span></span></span><br><span class="line"><span class="function"><span class="params">					CriteriaQuery&lt;?&gt; query, CriteriaBuilder cb)</span> </span>&#123;</span><br><span class="line">				Path path = root.get(<span class="string">"id"</span>);</span><br><span class="line">				Predicate predicate = cb.gt(path, <span class="number">5</span>);</span><br><span class="line">				<span class="keyword">return</span> predicate;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;;</span><br><span class="line"></span><br><span class="line">		Page&lt;Person&gt; page = personRepsotory.findAll(specification, pageable);</span><br><span class="line"></span><br><span class="line">		System.out.println(<span class="string">"总记录数: "</span> + page.getTotalElements());</span><br><span class="line">		System.out.println(<span class="string">"当前第几页: "</span> + (page.getNumber() + <span class="number">1</span>));</span><br><span class="line">		System.out.println(<span class="string">"总页数: "</span> + page.getTotalPages());</span><br><span class="line">		System.out.println(<span class="string">"当前页面的 List: "</span> + page.getContent());</span><br><span class="line">		System.out.println(<span class="string">"当前页面的记录数: "</span> + page.getNumberOfElements());</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h1 id="9-自定义-Repository-接口"><a href="#9-自定义-Repository-接口" class="headerlink" title="9. 自定义 Repository 接口"></a>9. 自定义 Repository 接口</h1><h2 id="9-1-步骤"><a href="#9-1-步骤" class="headerlink" title="9.1. 步骤"></a>9.1. 步骤</h2><ul>
<li>定义一个接口: 声明要添加的, 并自实现的方法</li>
<li>提供该接口的实现类: 类名需在要声明的 Repository 后添加 Impl, 并实现方法</li>
<li>声明 Repository 接口, 并继承 1) 声明的接口使用。<strong>注意:</strong> <strong>默认情况下, Spring Data 会在 base-package 中查找 “接口名 Impl” 作为实现类. 也可以通过 repository-impl-postfix 　声明后缀</strong></li>
</ul>
<h2 id="9-2-示例代码"><a href="#9-2-示例代码" class="headerlink" title="9.2. 示例代码"></a>9.2. 示例代码</h2><p><strong>PersonDao 接口</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PersonDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PersonDao 实现类</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.test.springdata;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.persistence.EntityManager;</span><br><span class="line"><span class="keyword">import</span> javax.persistence.PersistenceContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonRepsotoryImpl</span> <span class="keyword">implements</span> <span class="title">PersonDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@PersistenceContext</span></span><br><span class="line">	<span class="keyword">private</span> EntityManager entityManager;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		Person person = entityManager.find(Person<span class="class">.<span class="keyword">class</span>, 11)</span>;</span><br><span class="line">		System.out.println(<span class="string">"--&gt;"</span> + person);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>PersonRepository 类需要继承 PersonDao 接口</strong></p>
<p><strong>Test 方法</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCustomRepositoryMethod</span><span class="params">()</span></span>&#123;</span><br><span class="line">    personRepsotory.test();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="10-Query-注解"><a href="#10-Query-注解" class="headerlink" title="10. @Query 注解"></a>10. @Query 注解</h1><h2 id="10-1-使用-Query-自定义查询"><a href="#10-1-使用-Query-自定义查询" class="headerlink" title="10.1. 使用@Query 自定义查询"></a>10.1. 使用@Query 自定义查询</h2><p>这种查询可以声明在 Repository 方法中，<strong>摆脱像命名查询那样的约束</strong>，将查询直接在响应的接口方法中声明，结构更为清晰，这是 Spring data 的特有实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//为 @Query 注解传递参数的方式1: 命名参数的方式.</span></span><br><span class="line"><span class="meta">@Query</span>(<span class="string">"SELECT p FROM Person p WHERE p.lastName = :lastName AND p.email = :email"</span>)</span><br><span class="line"><span class="function">List&lt;Person&gt; <span class="title">testQueryAnnotationParams2</span><span class="params">(@Param(<span class="string">"email"</span>)</span> String email, @<span class="title">Param</span><span class="params">(<span class="string">"lastName"</span>)</span> String lastName)</span>;</span><br></pre></td></tr></table></figure>

<h2 id="10-2-使用-Query-的-nativeQuery-true"><a href="#10-2-使用-Query-的-nativeQuery-true" class="headerlink" title="10.2. 使用@Query 的 nativeQuery=true"></a>10.2. 使用@Query 的 nativeQuery=true</h2><p>这样可以使用原生的 SQL 查询</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置 nativeQuery=true 即可以使用原生的 SQL 查询</span></span><br><span class="line"><span class="meta">@Query</span>(value=<span class="string">"SELECT count(id) FROM jpa_persons"</span>, nativeQuery=<span class="keyword">true</span>)</span><br><span class="line"><span class="function"><span class="keyword">long</span> <span class="title">getTotalCount</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>注：详细内容参考 JpaRepository 示例代码</strong></p>
<h1 id="11-Modifying-注解"><a href="#11-Modifying-注解" class="headerlink" title="11. @Modifying 注解"></a>11. @Modifying 注解</h1><p>在 @Query 注解中编写 JPQL 语句, 但必须使用 @Modifying 进行修饰. 以通知 SpringData, 这是一个 UPDATE 或 DELETE 操作</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可以通过自定义的 JPQL 完成 UPDATE 和 DELETE 操作. 注意: JPQL 不支持使用 INSERT</span></span><br><span class="line"><span class="comment">//在 @Query 注解中编写 JPQL 语句, 但必须使用 @Modifying 进行修饰. 以通知 SpringData, 这是一个 UPDATE 或 DELETE 操作</span></span><br><span class="line"><span class="comment">//UPDATE 或 DELETE 操作需要使用事务, 此时需要定义 Service 层. 在 Service 层的方法上添加事务操作.</span></span><br><span class="line"><span class="comment">//默认情况下, SpringData 的每个方法上有事务, 但都是一个只读事务. 他们不能完成修改操作!</span></span><br><span class="line"><span class="meta">@Modifying</span></span><br><span class="line"><span class="meta">@Query</span>(<span class="string">"UPDATE Person p SET p.email = :email WHERE id = :id"</span>)</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updatePersonEmail</span><span class="params">(@Param(<span class="string">"id"</span>)</span> Integer id, @<span class="title">Param</span><span class="params">(<span class="string">"email"</span>)</span> String email)</span>;</span><br></pre></td></tr></table></figure>

<p><strong>注意：在调用的地方必须加事务，没有事务不能正常执行.</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/09/java/Lombok%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/09/java/Lombok%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">Lombok介绍及使用方法</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-09 15:21:41" itemprop="dateCreated datePublished" datetime="2018-11-09T15:21:41+08:00">2018-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/09/java/Lombok%E4%BB%8B%E7%BB%8D%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" class="post-meta-item leancloud_visitors" data-flag-title="Lombok介绍及使用方法" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-lombok简介"><a href="#1-lombok简介" class="headerlink" title="1. lombok简介"></a>1. lombok简介</h1><p>lombok是最近发现的一个非常好用的小工具，刚见到的时候就感觉非常惊艳，有一种相见恨晚的感觉，用了一段时间之后感觉的确挺不错，所以特此来推荐一下。</p>
<p><a href="https://projectlombok.org/" target="_blank" rel="noopener">lombok的官方地址：https://projectlombok.org/</a></p>
<p><a href="https://github.com/rzwitserloot/lombok" target="_blank" rel="noopener">lombok的Github地址：https://github.com/rzwitserloot/lombok</a></p>
<p>那么lombok到底是个什么呢，lombok是一个可以通过简单的注解的形式来帮助我们简化消除一些必须有但显得很臃肿的 Java 代码的工具，简单来说，比如我们新建了一个类，然后在其中写了几个字段，然后通常情况下我们需要手动去建立getter和setter方法啊，构造函数啊之类的，lombok的作用就是为了省去我们手动创建这些代码的麻烦，它能够在我们编译源码的时候自动帮我们生成这些方法。</p>
<p>lombok能够达到的效果就是在源码中不需要写一些通用的方法，但是在编译生成的字节码文件中会帮我们生成这些方法，这就是lombok的神奇作用。</p>
<p>虽然有人可能会说IDE里面都自带自动生成这些方法的功能，但是使用lombok会使你的代码看起来更加简洁，写起来也更加方便。</p>
<h1 id="2-lombok安装"><a href="#2-lombok安装" class="headerlink" title="2. lombok安装"></a>2. lombok安装</h1><p>lombok的安装跟一般引用jar包没有什么区别，可以到官网上下载最新的jar包，然后导入到项目里面就好啦。</p>
<h1 id="3-Maven添加依赖"><a href="#3-Maven添加依赖" class="headerlink" title="3. Maven添加依赖"></a>3. Maven添加依赖</h1><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Intellij idea开发的话需要安装Lombok plugin，同时设置 Setting -&gt; Compiler -&gt; Annotation Processors -&gt; Enable annotation processing勾选。</p>
<h1 id="4-lombok使用"><a href="#4-lombok使用" class="headerlink" title="4. lombok使用"></a>4. lombok使用</h1><p>lombok使用过程中主要是靠注解起作用的，官网上的文档里面有所有的注解，这里不一一罗列，只说明其中几个比较常用的。</p>
<h2 id="4-1-NonNull-可以帮助我们避免空指针。"><a href="#4-1-NonNull-可以帮助我们避免空指针。" class="headerlink" title="4.1. @NonNull: 可以帮助我们避免空指针。"></a>4.1. <code>@NonNull</code>: 可以帮助我们避免空指针。</h2><p>使用lombok：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.NonNull;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonNullExample</span> <span class="keyword">extends</span> <span class="title">Something</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NonNullExample</span><span class="params">(@NonNull Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"Hello"</span>);</span><br><span class="line">        <span class="keyword">this</span>.name = person.getName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不使用lombok：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonNullExample</span> <span class="keyword">extends</span> <span class="title">Something</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;  </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">NonNullExample</span><span class="params">(@NonNull Person person)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"Hello"</span>);</span><br><span class="line">        <span class="keyword">if</span> (person == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"person"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.name = person.getName();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-Cleanup-自动帮我们调用close-方法。"><a href="#4-2-Cleanup-自动帮我们调用close-方法。" class="headerlink" title="4.2. @Cleanup: 自动帮我们调用close()方法。"></a>4.2. <code>@Cleanup</code>: 自动帮我们调用<code>close()</code>方法。</h2><p>使用lombok：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Cleanup;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CleanupExample</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="meta">@Cleanup</span> InputStream in = <span class="keyword">new</span> FileInputStream(args[<span class="number">0</span>]);</span><br><span class="line">        <span class="meta">@Cleanup</span> OutputStream out = <span class="keyword">new</span> FileOutputStream(args[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10000</span>];</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> r = in.read(b);</span><br><span class="line">            <span class="keyword">if</span> (r == -<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">            out.write(b, <span class="number">0</span>, r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>不使用lombok：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CleanupExample</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">            InputStream in = <span class="keyword">new</span> FileInputStream(args[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                OutputStream out = <span class="keyword">new</span> FileOutputStream(args[<span class="number">1</span>]);</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">10000</span>];</span><br><span class="line">                    <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> r = in.read(b);</span><br><span class="line">                    <span class="keyword">if</span> (r == -<span class="number">1</span>) <span class="keyword">break</span>;</span><br><span class="line">                    out.write(b, <span class="number">0</span>, r);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (out != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        out.close();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (in != <span class="keyword">null</span>) &#123;</span><br><span class="line">                in.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-Getter-Setter-自动生成Getter-Setter方法"><a href="#4-3-Getter-Setter-自动生成Getter-Setter方法" class="headerlink" title="4.3. @Getter / @Setter: 自动生成Getter/Setter方法"></a>4.3. <code>@Getter / @Setter</code>: 自动生成Getter/Setter方法</h2><p>使用lombok：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AccessLevel;</span><br><span class="line">    <span class="keyword">import</span> lombok.Getter;</span><br><span class="line">    <span class="keyword">import</span> lombok.Setter;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetterSetterExample</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Getter</span> <span class="meta">@Setter</span> <span class="keyword">private</span> <span class="keyword">int</span> age = <span class="number">10</span>;</span><br><span class="line">        <span class="meta">@Setter</span>(AccessLevel.PROTECTED) <span class="keyword">private</span> String name;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>不使用lombok：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetterSetterExample</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-NoArgsConstructor"><a href="#4-4-NoArgsConstructor" class="headerlink" title="4.4. @NoArgsConstructor"></a>4.4. <code>@NoArgsConstructor</code></h2><p>自动生成无参数构造函数。</p>
<h2 id="4-5-AllArgsConstructor"><a href="#4-5-AllArgsConstructor" class="headerlink" title="4.5. @AllArgsConstructor"></a>4.5. <code>@AllArgsConstructor</code></h2><p>自动生成全参数构造函数。</p>
<h2 id="4-6-Data"><a href="#4-6-Data" class="headerlink" title="4.6. @Data"></a>4.6. <code>@Data</code></h2><p>自动为所有字段添加@ToString, @EqualsAndHashCode, @Getter方法，为非final字段添加@Setter,和@RequiredArgsConstructor!</p>
<p><strong><em>还有其他一些比如自动生成日志对象等等之类的注解可以到官方网站去了解，就不一一列举了。</em></strong></p>
<p><strong><a href="https://projectlombok.org/features/index.html" target="_blank" rel="noopener">官方文档https://projectlombok.org/features/index.html</a></strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/regexp/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%ADtest-exec-match%E6%96%B9%E6%B3%95%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/regexp/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%ADtest-exec-match%E6%96%B9%E6%B3%95%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">js正则表达式中test,exec,match方法的区别</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 22:04:38" itemprop="dateCreated datePublished" datetime="2018-11-08T22:04:38+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/regexp/" itemprop="url" rel="index">
                    <span itemprop="name">regexp</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/regexp/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%ADtest-exec-match%E6%96%B9%E6%B3%95%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-meta-item leancloud_visitors" data-flag-title="js正则表达式中test,exec,match方法的区别" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-test"><a href="#1-test" class="headerlink" title="1. test"></a>1. test</h1><p>test 返回 Boolean，查找对应的字符串中是否存在模式。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'1a1b1c'</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'1.'</span>, <span class="string">''</span>)</span><br><span class="line">alert(reg.test(str)) <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h1 id="2-exec"><a href="#2-exec" class="headerlink" title="2. exec"></a>2. exec</h1><p>exec 查找并返回当前的匹配结果，并以数组的形式返回。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'1a1b1c'</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'1.'</span>, <span class="string">''</span>)</span><br><span class="line"><span class="keyword">var</span> arr = reg.exec(str)</span><br></pre></td></tr></table></figure>

<p>如果不存在模式，则 arr 为 null，否则 arr 总是一个长度为 1 的数组，其值就是当前匹配项。arr 还有三个属性：index<br>当前匹配项的位置；lastIndex 当前匹配项结束的位置（index + 当前匹配项的长度）；<br>input 如上示例中 input 就是 str。<br>exec 方法受参数 g 的影响。若指定了 g，则下次调用 exec 时，会从上个匹配的 lastIndex 开始查找。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'1a1b1c'</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'1.'</span>, <span class="string">''</span>)</span><br><span class="line">alert(reg.exec(str)[<span class="number">0</span>])</span><br><span class="line">alert(reg.exec(str)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>上述两个输出都是 1a。现在再看看指定参数 g：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'1a1b1c'</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'1.'</span>, <span class="string">'g'</span>)</span><br><span class="line">alert(reg.exec(str)[<span class="number">0</span>])</span><br><span class="line">alert(reg.exec(str)[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<p>上述第一个输出 1a，第二个输出 1b。</p>
<h1 id="3-match"><a href="#3-match" class="headerlink" title="3. match"></a>3. match</h1><p>match 是 String 对象的一个方法。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'1a1b1c'</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'1.'</span>, <span class="string">''</span>)</span><br><span class="line">alert(str.match(reg))</span><br></pre></td></tr></table></figure>

<p>match 这个方法有点像 exec，但 exec 是 RegExp 对象的方法；math 是 String 对象的方法。二者还有一个不同点，就是对参数 g 的解释。<br>如果指定了参数 g，那么 match 一次返回所有的结果。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'1a1b1c'</span></span><br><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'1.'</span>, <span class="string">'g'</span>)</span><br><span class="line">alert(str.match(reg))</span><br><span class="line"><span class="comment">//alert(str.match(reg)); // 此句同上句的结果是一样的</span></span><br></pre></td></tr></table></figure>

<p>此结果为一个数组，有三个元素，分别是：1a、1b、1c。<br>JavaScript 中经常用到正则表达式, 而正则表达式中经常用到 Match 和 Test 这两个函数,当然还有 Exec. 这里以代码实例来区分它们之间的不同吧.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/regexp/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BEexec%E4%B8%8Ematch%E7%9A%84%E5%8C%BA%E5%88%AB%E8%AF%B4%E6%98%8E/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/regexp/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BEexec%E4%B8%8Ematch%E7%9A%84%E5%8C%BA%E5%88%AB%E8%AF%B4%E6%98%8E/" class="post-title-link" itemprop="url">js正则表达exec与match的区别说明</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 21:49:20" itemprop="dateCreated datePublished" datetime="2018-11-08T21:49:20+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/js/" itemprop="url" rel="index">
                    <span itemprop="name">js</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/regexp/js%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BEexec%E4%B8%8Ematch%E7%9A%84%E5%8C%BA%E5%88%AB%E8%AF%B4%E6%98%8E/" class="post-meta-item leancloud_visitors" data-flag-title="js正则表达exec与match的区别说明" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-第一种定义"><a href="#1-第一种定义" class="headerlink" title="1. 第一种定义"></a>1. 第一种定义</h1><p><code>new RegExp(pattern, attributes);</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'abc'</span>, <span class="string">'g'</span>)</span><br></pre></td></tr></table></figure>

<p>其中<code>pattern</code>为表示表达式内容,如上表示匹配<code>abc</code></p>
<p><code>attributes</code>：<code>g</code>,全局匹配，<code>i</code>不区分大小写，<code>m</code>执行多行匹配，用最多的为<code>g</code>和<code>i</code></p>
<h1 id="2-第二种定义"><a href="#2-第二种定义" class="headerlink" title="2. 第二种定义"></a>2. 第二种定义</h1><p><code>/pattern/attributes.**</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/abc/g</span></span><br></pre></td></tr></table></figure>

<h1 id="3-exec-和-match-的区别"><a href="#3-exec-和-match-的区别" class="headerlink" title="3. exec 和 match 的区别"></a>3. exec 和 match 的区别</h1><h2 id="3-1-exec-是正则表达式的方法，而不是字符串的方法，它的参数才是字符串"><a href="#3-1-exec-是正则表达式的方法，而不是字符串的方法，它的参数才是字符串" class="headerlink" title="3.1. exec 是正则表达式的方法，而不是字符串的方法，它的参数才是字符串"></a>3.1. exec 是正则表达式的方法，而不是字符串的方法，它的参数才是字符串</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'abc'</span>)</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'3abc4，5abc6'</span></span><br><span class="line">reg.exec(str)</span><br></pre></td></tr></table></figure>

<h2 id="3-2-match-是字符串执行匹配正则表达式规则的方法，他的参数是正则表达"><a href="#3-2-match-是字符串执行匹配正则表达式规则的方法，他的参数是正则表达" class="headerlink" title="3.2. match 是字符串执行匹配正则表达式规则的方法，他的参数是正则表达"></a>3.2. match 是字符串执行匹配正则表达式规则的方法，他的参数是正则表达</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'abc'</span>)</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'3abc4,5abc6'</span></span><br><span class="line">str.match(reg)</span><br></pre></td></tr></table></figure>

<h2 id="3-3-exec-和-match-返回的都是数组"><a href="#3-3-exec-和-match-返回的都是数组" class="headerlink" title="3.3. exec 和 match 返回的都是数组"></a>3.3. exec 和 match 返回的都是数组</h2><p>如果 exec 执行的正则表达式没有子表达式(小括号内的内容，如/abc(\s<em>)/中的(\s</em>) )，如果有匹配，就返回第一个匹配的字符串内容，此时的数组仅有一个元素，如果没有匹配返回 null;</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'abc'</span>)</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'3abc4,5abc6'</span></span><br><span class="line">alert(reg.exec(str))</span><br><span class="line">alert(str.match(reg))</span><br></pre></td></tr></table></figure>

<p>执行如上代码，你会发现两者内容均为一样：abc，</p>
<h2 id="3-4-如果定义正则表达对象为全局匹配"><a href="#3-4-如果定义正则表达对象为全局匹配" class="headerlink" title="3.4. 如果定义正则表达对象为全局匹配"></a>3.4. 如果定义正则表达对象为全局匹配</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'abc'</span>, <span class="string">'g'</span>)</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'3abc4,5abc6'</span></span><br><span class="line">alert(reg.exec(str))</span><br><span class="line">alert(str.match(reg))</span><br></pre></td></tr></table></figure>

<p>则 为 abc 和 abc,abc；因为 match 执行了全局匹配查询；而 exec 如果没有子表达式只会找到一个匹配的即返回。</p>
<h2 id="3-5-当表示中含有子表达式的情况"><a href="#3-5-当表示中含有子表达式的情况" class="headerlink" title="3.5. 当表示中含有子表达式的情况"></a>3.5. 当表示中含有子表达式的情况</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'a(bc)'</span>)</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'3abc4,5abc6'</span></span><br><span class="line">alert(reg.exec(str))</span><br><span class="line">alert(str.match(reg))</span><br></pre></td></tr></table></figure>

<p>你会发现两者执行的结果都是：abc,bc;</p>
<h2 id="3-6-当如果正则表达式对象定义为为全局匹配"><a href="#3-6-当如果正则表达式对象定义为为全局匹配" class="headerlink" title="3.6. 当如果正则表达式对象定义为为全局匹配"></a>3.6. 当如果正则表达式对象定义为为全局匹配</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> reg = <span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">'a(bc)'</span>, <span class="string">'g'</span>)</span><br><span class="line"><span class="keyword">var</span> str = <span class="string">'3abc4,5abc6'</span></span><br><span class="line">alert(reg.exec(str))</span><br><span class="line">alert(str.match(reg))</span><br></pre></td></tr></table></figure>

<p>则两者返回的结果是 abc,bc 和 abc,abc,</p>
<h2 id="3-7-结论"><a href="#3-7-结论" class="headerlink" title="3.7. 结论"></a>3.7. 结论</h2><ol>
<li><p>当正则表达式无子表达式，并且定义为非全局匹配时，exec 和 match 执行的结果是一样，均返回第一个匹配的字符串内容；</p>
</li>
<li><p>当正则表达式无子表达式，并且定义为全局匹配时，exec 和 match 执行，做存在多处匹配内容，则 match 返回的是多个元素数组；</p>
</li>
<li><p>当正则表达式有子表示时，并且定义为非全局匹配，exec 和 match 执行的结果是一样如上边的第 5 种情况；</p>
</li>
<li><p>当正则表达式有子表示时，并且定义为全局匹配，exec 和 match 执行的结果不一样，此时 match 将忽略子表达式，只查找全匹配正则表达式并返回所有内容，如上第 6 种情况；</p>
</li>
</ol>
<p>也就说，exec 与全局是否定义无关系，而 match 则于全局相关联，当定义为非全局，两者执行结果相同</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/npm/npm%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4npm-run-script%E7%9A%84%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/npm/npm%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4npm-run-script%E7%9A%84%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">npm脚本命令npm run script的使用</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 20:41:40" itemprop="dateCreated datePublished" datetime="2018-11-08T20:41:40+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/npm/" itemprop="url" rel="index">
                    <span itemprop="name">npm</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/npm/npm%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4npm-run-script%E7%9A%84%E4%BD%BF%E7%94%A8/" class="post-meta-item leancloud_visitors" data-flag-title="npm脚本命令npm run script的使用" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-自定义命令"><a href="#1-自定义命令" class="headerlink" title="1. 自定义命令"></a>1. 自定义命令</h1><p><code>npm</code>可以在项目<code>package.json</code>里面自定义脚本命令</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">        <span class="attr">"dev"</span>: <span class="string">"webpack -w"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>package.json</code>文件中的字段<code>scripts</code>的每一个属性都是一个自定义的脚本命令。</p>
<p>在命令行中可以通过执行<code>npm run dev</code>来执行这段脚本。</p>
<h1 id="2-执行原理"><a href="#2-执行原理" class="headerlink" title="2. 执行原理"></a>2. 执行原理</h1><p>使用<code>npm run script</code>执行脚本的时候都会创建一个<code>shell</code>，然后在<code>shell</code>中执行指定的脚本。</p>
<p>这个<code>shell</code>会将当前项目的可执行依赖目录（即<code>node_modules/.bin</code>）添加到环境变量<code>path</code>中，当执行之后之后再恢复原样。就是说脚本命令中的依赖名会直接找到<code>node_modules/.bin</code>下面的对应脚本，而不需要加上路径。</p>
<h1 id="3-执行顺序"><a href="#3-执行顺序" class="headerlink" title="3. 执行顺序"></a>3. 执行顺序</h1><p>一个 npm 脚本可以执行多个任务，这些任务之间可以指定不同的执行顺序。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'&amp;'</span> 并行执行顺序，同时执行</span><br><span class="line"><span class="string">"dev"</span>: <span class="string">"node test.js &amp; webpack"</span></span><br><span class="line"></span><br><span class="line"><span class="string">'&amp;&amp;'</span>继发顺序，执行前面之后才可以执行后面</span><br><span class="line"><span class="string">"dev"</span>: <span class="string">"node test.js &amp;&amp; webpack"</span></span><br></pre></td></tr></table></figure>

<h1 id="4-顺序钩子"><a href="#4-顺序钩子" class="headerlink" title="4. 顺序钩子"></a>4. 顺序钩子</h1><p>npm 脚本自带两个顺序钩子，’pre’ 和 ‘post’</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"predev"</span>: <span class="string">"node test_one.js"</span>,</span><br><span class="line"><span class="string">"dev"</span>: <span class="string">"node test_two.js"</span>,</span><br><span class="line"><span class="string">"postdev"</span>: <span class="string">"node test_three.js"</span></span><br></pre></td></tr></table></figure>

<p>当执行 <code>npm run dev 的时候默认就会执行</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run predev &amp;&amp; npm run dev &amp;&amp; npm run postdev</span><br></pre></td></tr></table></figure>

<h1 id="5-获取当前正在运行的脚本名称"><a href="#5-获取当前正在运行的脚本名称" class="headerlink" title="5. 获取当前正在运行的脚本名称"></a>5. 获取当前正在运行的脚本名称</h1><p><code>npm</code>提供一个<code>npm_lifecycle_event</code>变量，返回当前正在运行的脚本名称，可以配合顺序钩子使用</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br><span class="line"></span><br><span class="line">const target = process.env.npm_lifecycle_event;</span><br><span class="line"><span class="keyword">if</span>(target === <span class="string">'predev'</span>)&#123;</span><br><span class="line">  console.log(<span class="string">'the process is predev'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(target === <span class="string">'dev'</span>)&#123;</span><br><span class="line">  console.log(<span class="string">'the process is dev'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(target === <span class="string">'postdev'</span>)&#123;</span><br><span class="line">  console.log(<span class="string">'this process is postdev'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="6-四个可以简写的脚本执行命令"><a href="#6-四个可以简写的脚本执行命令" class="headerlink" title="6. 四个可以简写的脚本执行命令"></a>6. 四个可以简写的脚本执行命令</h1><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm start === npm run start</span><br><span class="line">npm stop === npm run stop</span><br><span class="line">npm <span class="built_in">test</span> === npm run <span class="built_in">test</span></span><br><span class="line">npm restart === npm run stop &amp;&amp; npm run restart &amp;&amp; npm run start</span><br></pre></td></tr></table></figure>

<h1 id="7-使用-package-json-内部变量"><a href="#7-使用-package-json-内部变量" class="headerlink" title="7. 使用 package.json 内部变量"></a>7. 使用 package.json 内部变量</h1><p>通过 npm<em>package</em>前缀，npm 脚本可以拿到 npm 的内部变量</p>
<p>package.json:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"zzpzds"</span>,</span><br><span class="line">    <span class="attr">"script"</span>: <span class="string">"node test.js"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">test.js:</span><br><span class="line"><span class="built_in">console</span>.log(process.env.npm_package_name) <span class="comment">//zzpzds</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/npm/npm%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/npm/npm%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%A1/" class="post-title-link" itemprop="url">npm使用小计</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 20:24:30" itemprop="dateCreated datePublished" datetime="2018-11-08T20:24:30+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/npm/" itemprop="url" rel="index">
                    <span itemprop="name">npm</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/npm/npm%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%A1/" class="post-meta-item leancloud_visitors" data-flag-title="npm使用小计" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="npm-run"><a href="#npm-run" class="headerlink" title="npm run"></a><code>npm run</code></h2><p>使用<code>npm run</code>的方便之处在于，<code>npm</code>会自动把<code>node_modules/.bin</code>加入<code>$PATH</code>，这样你可以直接运行依赖程序和开发依赖程序，不用全局安装了。</p>
<h2 id="精简命令"><a href="#精简命令" class="headerlink" title="精简命令"></a>精简命令</h2><p>如果你发现在单个 scripts 条目中塞了一大堆命令，那你可以考虑重构一下，把一些命令放到别的地方，比如/bin。</p>
<p>你可以用任何语言编写这个脚本，比如 bash、node 或 perl。只需要在脚本上加上合适的#!行。还有，别忘了 chmod +x。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">(<span class="built_in">cd</span> site/main; browserify browser/main.js | uglifyjs -mc &gt; static/bundle.js)</span><br><span class="line">(<span class="built_in">cd</span> site/xyz; browserify browser.js &gt; static/bundle.js)</span><br></pre></td></tr></table></figure>

<p>package.json</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">        <span class="attr">"build-js"</span>: <span class="string">"bin/build.sh"</span>,</span><br><span class="line">        <span class="attr">"start"</span>: <span class="string">"node ./bin/www"</span>,</span><br><span class="line">        <span class="attr">"lint"</span>: <span class="string">"eslint --ext .js ."</span>,</span><br><span class="line">        <span class="attr">"lint-fix"</span>: <span class="string">"eslint  --fix --ext .js ."</span>,</span><br><span class="line">        <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就可以通过<code>npm run build-js</code>执行负载的命令了。</p>
<h2 id="升级某个-npm-包的版本"><a href="#升级某个-npm-包的版本" class="headerlink" title="升级某个 npm 包的版本"></a>升级某个 npm 包的版本</h2><p>其实就是重新安装一下即可。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将全局的wepy升级到最新版本</span></span><br><span class="line">npm i -g wepy-cli</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将本地的fs升级到最新版本</span></span><br><span class="line">npm i -S fs</span><br></pre></td></tr></table></figure>

<h2 id="查看-npm-全局包的位置"><a href="#查看-npm-全局包的位置" class="headerlink" title="查看 npm 全局包的位置"></a>查看 npm 全局包的位置</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm root -g</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/babel-node/babel-node%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/babel-node/babel-node%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%A1/" class="post-title-link" itemprop="url">babel-node使用小计</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 19:18:31" itemprop="dateCreated datePublished" datetime="2018-11-08T19:18:31+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/babel-node/" itemprop="url" rel="index">
                    <span itemprop="name">babel-node</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/babel-node/babel-node%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%A1/" class="post-meta-item leancloud_visitors" data-flag-title="babel-node使用小计" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 全局安装babel-node</span></span><br><span class="line">npm i -g babel-cli</span><br><span class="line"><span class="comment"># 安装成功之后，查看babel-node版本</span></span><br><span class="line">babel-node --version</span><br><span class="line">/c/Users/gesha_000/AppData/Roaming/npm/babel-node --version</span><br><span class="line"></span><br><span class="line"><span class="comment"># 项目本地安装</span></span><br><span class="line">npm i -D babel-cli</span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line">./node_modules/.bin/babel-node --version</span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">./node_modules/babel-cli/bin/babel-node.js --version</span><br></pre></td></tr></table></figure>

<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>通过 babel-node 执行*.js 时，会自动在当前根目录下查找.babelrc，并根据配置执行</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"presets"</span>: [<span class="string">"es2015"</span>, <span class="string">"stage-0"</span>, <span class="string">"stage-1"</span>, <span class="string">"stage-2"</span>],</span><br><span class="line">    <span class="attr">"plugins"</span>: []</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意这些<code>presets</code>要安装到当前目录下，可以<code>package.json</code>的<code>devDependencies</code>中添加，然后通过<code>npm i</code>统一安装。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">"devDependencies": &#123;</span><br><span class="line">  "babel-cli": "^6.26.0",</span><br><span class="line">  "babel-eslint": "^8.0.1",</span><br><span class="line">  "babel-preset-es2015": "^6.24.1",</span><br><span class="line">  "babel-preset-stage-0": "^6.24.1",</span><br><span class="line">  "babel-preset-stage-1": "^6.24.1",</span><br><span class="line">  "babel-preset-stage-2": "^6.24.1",</span><br><span class="line">  "babel-preset-stage-3": "^6.24.1",</span><br><span class="line">  "eslint": "^4.9.0",</span><br><span class="line">  "eslint-config-airbnb": "^16.1.0",</span><br><span class="line">  "eslint-plugin-import": "^2.7.0",</span><br><span class="line">  "eslint-plugin-jsx-a11y": "^6.0.2",</span><br><span class="line">  "eslint-plugin-react": "^7.4.0",</span><br><span class="line">  "pre-commit": "^1.2.2"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/java/Java%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8CMySql%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94%E8%A1%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/java/Java%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8CMySql%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94%E8%A1%A8/" class="post-title-link" itemprop="url">Java数据类型和MySql数据类型对应表</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 10:40:10" itemprop="dateCreated datePublished" datetime="2018-11-08T10:40:10+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/java/Java%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8CMySql%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94%E8%A1%A8/" class="post-meta-item leancloud_visitors" data-flag-title="Java数据类型和MySql数据类型对应表" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>java mysql 数据类型对照  </p>
<table>
<thead>
<tr>
<th>类型名称</th>
<th>显示长度</th>
<th>数据库类型</th>
<th>JAVA类型</th>
<th>JDBC类型索引(int)</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>VARCHAR</td>
<td>L+N</td>
<td>VARCHAR</td>
<td>java.lang.String</td>
<td>12</td>
<td></td>
</tr>
<tr>
<td>CHAR</td>
<td>N</td>
<td>CHAR</td>
<td>java.lang.String</td>
<td>1</td>
<td></td>
</tr>
<tr>
<td>BLOB</td>
<td>L+N</td>
<td>BLOB</td>
<td>java.lang.byte[]</td>
<td>-4</td>
<td></td>
</tr>
<tr>
<td>TEXT</td>
<td>65535</td>
<td>VARCHAR</td>
<td>java.lang.String</td>
<td>-1</td>
<td></td>
</tr>
<tr>
<td>INTEGER</td>
<td>4</td>
<td>INTEGER UNSIGNED</td>
<td>java.lang.Long</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>TINYINT</td>
<td>3</td>
<td>TINYINT UNSIGNED</td>
<td>java.lang.Integer</td>
<td>-6</td>
<td></td>
</tr>
<tr>
<td>SMALLINT</td>
<td>5</td>
<td>SMALLINT UNSIGNED</td>
<td>java.lang.Integer</td>
<td>5</td>
<td></td>
</tr>
<tr>
<td>MEDIUMINT</td>
<td>8</td>
<td>MEDIUMINT UNSIGNED</td>
<td>java.lang.Integer</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>BIT</td>
<td>1</td>
<td>BIT</td>
<td>java.lang.Boolean</td>
<td>-7</td>
<td></td>
</tr>
<tr>
<td>BIGINT</td>
<td>20</td>
<td>BIGINT UNSIGNED</td>
<td>java.math.BigInteger</td>
<td>-5</td>
<td></td>
</tr>
<tr>
<td>FLOAT</td>
<td>4+8</td>
<td>FLOAT</td>
<td>java.lang.Float</td>
<td>7</td>
<td></td>
</tr>
<tr>
<td>DOUBLE</td>
<td>22</td>
<td>DOUBLE</td>
<td>java.lang.Double</td>
<td>8</td>
<td></td>
</tr>
<tr>
<td>DECIMAL</td>
<td>11</td>
<td>DECIMAL</td>
<td>java.math.BigDecimal</td>
<td>3</td>
<td></td>
</tr>
<tr>
<td>BOOLEAN</td>
<td>1</td>
<td>同TINYINT</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ID</td>
<td>11</td>
<td>PK (INTEGER UNSIGNED)</td>
<td>java.lang.Long</td>
<td>4</td>
<td></td>
</tr>
<tr>
<td>DATE</td>
<td>10</td>
<td>DATE</td>
<td>java.sql.Date</td>
<td>91</td>
<td></td>
</tr>
<tr>
<td>TIME</td>
<td>8</td>
<td>TIME</td>
<td>java.sql.Time</td>
<td>92</td>
<td></td>
</tr>
<tr>
<td>DATETIME</td>
<td>19</td>
<td>DATETIME</td>
<td>java.sql.Timestamp</td>
<td>93</td>
<td></td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>19</td>
<td>TIMESTAMP</td>
<td>java.sql.Timestamp</td>
<td>93</td>
<td></td>
</tr>
<tr>
<td>YEAR</td>
<td>4</td>
<td>YEAR</td>
<td>java.sql.Date</td>
<td>91</td>
<td></td>
</tr>
</tbody></table>
<p>对于bolb，一般用于对图片的数据库存储，原理是把图片打成二进制，然后进行的一种存储方式，在java中对应byte［］数组。  </p>
<p>对于boolen类型，在mysql数据库中，个人认为用int类型代替较好，对bit操作不是很方便，尤其是在具有web页面开发的项目中，表示0/1，对应java类型的Integer较好。</p>
<p>decimal列的声明语法是decimal(m,d)。</p>
<p>在mysql5.1中，参数的取值范围：<br>1、M是数字的最大数（精度）。其范围为1～65（在较旧的MySQL版本中，允许的范围是1～254）。<br>2、D是小数点右侧数字的数目（标度）。其范围是0～30，但不得超过M。<br>说明：float占4个字节，double占8个字节，decimail(M,D)占M+2个字节。<br>如DECIMAL(5, 2) 的最大值为9 9 9 9 . 9 9，因为有7 个字节可用。 </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2018/11/08/es/export-default-%E5%92%8Cexport%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/08/es/export-default-%E5%92%8Cexport%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">export default 和 export 区别</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-11-08 09:07:18" itemprop="dateCreated datePublished" datetime="2018-11-08T09:07:18+08:00">2018-11-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/es/" itemprop="url" rel="index">
                    <span itemprop="name">es</span>
                  </a>
                </span>
            </span>

          
            <span id="/2018/11/08/es/export-default-%E5%92%8Cexport%E5%8C%BA%E5%88%AB/" class="post-meta-item leancloud_visitors" data-flag-title="export default 和 export 区别" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-总体介绍"><a href="#1-总体介绍" class="headerlink" title="1. 总体介绍"></a>1. 总体介绍</h1><h2 id="1-1-export-与-export-default-均可用于导出常量、函数、文件、模块等"><a href="#1-1-export-与-export-default-均可用于导出常量、函数、文件、模块等" class="headerlink" title="1.1. export 与 export default 均可用于导出常量、函数、文件、模块等"></a>1.1. export 与 export default 均可用于导出常量、函数、文件、模块等</h2><h2 id="1-2-在一个文件或模块中，export、import-可以有多个，export-default-仅有一个"><a href="#1-2-在一个文件或模块中，export、import-可以有多个，export-default-仅有一个" class="headerlink" title="1.2. 在一个文件或模块中，export、import 可以有多个，export default 仅有一个"></a>1.2. 在一个文件或模块中，export、import 可以有多个，export default 仅有一个</h2><h2 id="1-3-通过-export-方式导出，在导入时要加-，export-default-则不能"><a href="#1-3-通过-export-方式导出，在导入时要加-，export-default-则不能" class="headerlink" title="1.3. 通过 export 方式导出，在导入时要加{ }，export default 则不能"></a>1.3. 通过 export 方式导出，在导入时要加{ }，export default 则不能</h2><h2 id="1-4-注意事项"><a href="#1-4-注意事项" class="headerlink" title="1.4. 注意事项"></a>1.4. 注意事项</h2><ul>
<li>输出单个值，使用<code>export default</code></li>
<li>输出多个值，使用<code>export</code></li>
<li><code>export default</code>与普通的<code>export</code>不要同时使用</li>
</ul>
<h1 id="2-示例"><a href="#2-示例" class="headerlink" title="2. 示例"></a>2. 示例</h1><h2 id="2-1-export"><a href="#2-1-export" class="headerlink" title="2.1. export"></a>2.1. export</h2><h3 id="2-1-1-逐个导出"><a href="#2-1-1-逐个导出" class="headerlink" title="2.1.1. 逐个导出"></a>2.1.1. 逐个导出</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> str = <span class="string">'blablabla~'</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">sth</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sth</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对应的导入方式：</span></span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; str, log &#125; <span class="keyword">from</span> <span class="string">'a'</span> <span class="comment">//也可以分开写两次，导入的时候带花括号</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-import-as"><a href="#2-1-2-import-as" class="headerlink" title="2.1.2. import * as"></a>2.1.2. import * as</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> str = <span class="string">'blablabla~'</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">sth</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sth</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对应的导入方式：</span></span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> utils <span class="keyword">from</span> <span class="string">'a'</span> <span class="comment">//也可以分开写两次，导入的时候带花括号</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-一次导出"><a href="#2-1-3-一次导出" class="headerlink" title="2.1.3. 一次导出"></a>2.1.3. 一次导出</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">'blablabla~'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params">sth</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> sth</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; str, log &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对应的导入方式：</span></span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; str, log &#125; <span class="keyword">from</span> <span class="string">'a'</span> <span class="comment">//也可以分开写两次，导入的时候带花括号</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-export-default"><a href="#2-2-export-default" class="headerlink" title="2.2. export default"></a>2.2. export default</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//a.js</span></span><br><span class="line"><span class="keyword">const</span> str = <span class="string">'blablabla~'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> str</span><br><span class="line"><span class="comment">//其实此处相当于为str变量值"`blablabla`"起了一个系统默认的变量名default，自然default只能有一个值，所以一个文件内不能有多个export default。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对应的导入方式：</span></span><br><span class="line"><span class="comment">//b.js</span></span><br><span class="line"><span class="keyword">import</span> str <span class="keyword">from</span> <span class="string">'a'</span> <span class="comment">//导入的时候没有花括号</span></span><br><span class="line"><span class="comment">//本质上，a.js文件的export default输出一个叫做default的变量，然后系统允许你为它取任意名字。所以可以为import的模块起任何变量名，且不需要用大括号包含</span></span><br></pre></td></tr></table></figure>

<p>import 的文件会自动执行一次。</p>
<p><strong><code>import会加载且仅加载一次导入的模块</code></strong></p>
<h3 id="2-2-1-export-as-default-命名导出（Named-Exports）"><a href="#2-2-1-export-as-default-命名导出（Named-Exports）" class="headerlink" title="2.2.1. export as default 命名导出（Named Exports）"></a>2.2.1. export as default 命名导出（Named Exports）</h3><p><code>React.lazy</code> 目前只支持默认导出（default exports）。如果你想被引入的模块使用命名导出（named exports），你可以创建一个中间模块，来重新导出为默认模块。这能保证 tree shaking 不会出错，并且不必引入不需要的组件。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ManyComponents.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> MyComponent = <span class="comment">/* ... */</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> MyUnusedComponent = <span class="comment">/* ... */</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyComponent.js</span></span><br><span class="line"><span class="keyword">export</span> &#123; MyComponent <span class="keyword">as</span> <span class="keyword">default</span> &#125; <span class="keyword">from</span> <span class="string">'./ManyComponents.js'</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyApp.js</span></span><br><span class="line"><span class="keyword">import</span> React, &#123; lazy &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">const</span> MyComponent = lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./MyComponent.js'</span>))</span><br></pre></td></tr></table></figure>

<h3 id="2-2-2-export-default-和-export"><a href="#2-2-2-export-default-和-export" class="headerlink" title="2.2.2. export default 和 export"></a>2.2.2. export default 和 export</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyComponent.js</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// 使用这种方式代替...</span></span><br><span class="line">MyComponent.someFunction = someFunction</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyComponent</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...单独导出该方法...</span></span><br><span class="line"><span class="keyword">export</span> &#123; someFunction &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// App.js</span></span><br><span class="line"><span class="comment">// ...并在要使用的组件中，import 它们</span></span><br><span class="line"><span class="keyword">import</span> MyComponent, &#123; someFunction &#125; <span class="keyword">from</span> <span class="string">'./MyComponent.js'</span></span><br></pre></td></tr></table></figure>

<h2 id="2-3-示例"><a href="#2-3-示例" class="headerlink" title="2.3. 示例"></a>2.3. 示例</h2><h3 id="2-3-1-对导入的库进行处理后再导出"><a href="#2-3-1-对导入的库进行处理后再导出" class="headerlink" title="2.3.1. 对导入的库进行处理后再导出"></a>2.3.1. 对导入的库进行处理后再导出</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Parse <span class="keyword">from</span> <span class="string">'parse'</span></span><br><span class="line"><span class="keyword">import</span> config <span class="keyword">from</span> <span class="string">'../config.json'</span></span><br><span class="line"></span><br><span class="line">Parse.initialize(config.appId || <span class="string">'zV9Ja1RnaUYZH5o'</span>)</span><br><span class="line"></span><br><span class="line">Parse.serverURL = config.serverURL || <span class="string">'http://localhost:1338/api'</span></span><br><span class="line">Parse.Promise.enableAPlusCompliant()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Parse</span><br></pre></td></tr></table></figure>

<h3 id="2-3-2-moment-汉化处理"><a href="#2-3-2-moment-汉化处理" class="headerlink" title="2.3.2. moment 汉化处理"></a>2.3.2. moment 汉化处理</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> momentDefault <span class="keyword">from</span> <span class="string">'moment'</span></span><br><span class="line"></span><br><span class="line">momentDefault.locale(<span class="string">'zh-cn'</span>, &#123;</span><br><span class="line">    months: <span class="string">'一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月'</span>.split(</span><br><span class="line">        <span class="string">'_'</span></span><br><span class="line">    ),</span><br><span class="line">    monthsShort: <span class="string">'1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月'</span>.split(</span><br><span class="line">        <span class="string">'_'</span></span><br><span class="line">    ),</span><br><span class="line">    weekdays: <span class="string">'星期日_星期一_星期二_星期三_星期四_星期五_星期六'</span>.split(<span class="string">'_'</span>),</span><br><span class="line">    weekdaysShort: <span class="string">'周日_周一_周二_周三_周四_周五_周六'</span>.split(<span class="string">'_'</span>),</span><br><span class="line">    weekdaysMin: <span class="string">'日_一_二_三_四_五_六'</span>.split(<span class="string">'_'</span>),</span><br><span class="line">    longDateFormat: &#123;</span><br><span class="line">        LT: <span class="string">'HH:mm'</span>,</span><br><span class="line">        LTS: <span class="string">'HH:mm:ss'</span>,</span><br><span class="line">        L: <span class="string">'YYYY-MM-DD'</span>,</span><br><span class="line">        LL: <span class="string">'YYYY年MM月DD日'</span>,</span><br><span class="line">        LLL: <span class="string">'YYYY年MM月DD日Ah点mm分'</span>,</span><br><span class="line">        LLLL: <span class="string">'YYYY年MM月DD日ddddAh点mm分'</span>,</span><br><span class="line">        l: <span class="string">'YYYY-M-D'</span>,</span><br><span class="line">        ll: <span class="string">'YYYY年M月D日'</span>,</span><br><span class="line">        lll: <span class="string">'YYYY年M月D日 HH:mm'</span>,</span><br><span class="line">        llll: <span class="string">'YYYY年M月D日dddd HH:mm'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    meridiemParse: <span class="regexp">/凌晨|早上|上午|中午|下午|晚上/</span>,</span><br><span class="line">    meridiemHour: <span class="function"><span class="keyword">function</span>(<span class="params">hour, meridiem</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (hour === <span class="number">12</span>) &#123;</span><br><span class="line">            hour = <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (meridiem === <span class="string">'凌晨'</span> || meridiem === <span class="string">'早上'</span> || meridiem === <span class="string">'上午'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> hour</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (meridiem === <span class="string">'下午'</span> || meridiem === <span class="string">'晚上'</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> hour + <span class="number">12</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// '中午'</span></span><br><span class="line">            <span class="keyword">return</span> hour &gt;= <span class="number">11</span> ? hour : hour + <span class="number">12</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    meridiem: <span class="function"><span class="keyword">function</span>(<span class="params">hour, minute, isLower</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> hm = hour * <span class="number">100</span> + minute</span><br><span class="line">        <span class="keyword">if</span> (hm &lt; <span class="number">600</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'凌晨'</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hm &lt; <span class="number">900</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'早上'</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hm &lt; <span class="number">1130</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'上午'</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hm &lt; <span class="number">1230</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'中午'</span></span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (hm &lt; <span class="number">1800</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'下午'</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'晚上'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    calendar: &#123;</span><br><span class="line">        sameDay: <span class="string">'[今天]LT'</span>,</span><br><span class="line">        nextDay: <span class="string">'[明天]LT'</span>,</span><br><span class="line">        nextWeek: <span class="string">'[下]ddddLT'</span>,</span><br><span class="line">        lastDay: <span class="string">'[昨天]LT'</span>,</span><br><span class="line">        lastWeek: <span class="string">'[上]ddddLT'</span>,</span><br><span class="line">        sameElse: <span class="string">'L'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    dayOfMonthOrdinalParse: <span class="regexp">/\d&#123;1,2&#125;(日|月|周)/</span>,</span><br><span class="line">    ordinal: <span class="function"><span class="keyword">function</span>(<span class="params">number, period</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">switch</span> (period) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'d'</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'D'</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'DDD'</span>:</span><br><span class="line">                <span class="keyword">return</span> number + <span class="string">'日'</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">'M'</span>:</span><br><span class="line">                <span class="keyword">return</span> number + <span class="string">'月'</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">'w'</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="string">'W'</span>:</span><br><span class="line">                <span class="keyword">return</span> number + <span class="string">'周'</span></span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">return</span> number</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    relativeTime: &#123;</span><br><span class="line">        future: <span class="string">'%s内'</span>,</span><br><span class="line">        past: <span class="string">'%s前'</span>,</span><br><span class="line">        s: <span class="string">'几秒'</span>,</span><br><span class="line">        ss: <span class="string">'%d秒'</span>,</span><br><span class="line">        m: <span class="string">'1分钟'</span>,</span><br><span class="line">        mm: <span class="string">'%d分钟'</span>,</span><br><span class="line">        h: <span class="string">'1小时'</span>,</span><br><span class="line">        hh: <span class="string">'%d小时'</span>,</span><br><span class="line">        d: <span class="string">'1天'</span>,</span><br><span class="line">        dd: <span class="string">'%d天'</span>,</span><br><span class="line">        M: <span class="string">'1个月'</span>,</span><br><span class="line">        MM: <span class="string">'%d个月'</span>,</span><br><span class="line">        y: <span class="string">'1年'</span>,</span><br><span class="line">        yy: <span class="string">'%d年'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    week: &#123;</span><br><span class="line">        <span class="comment">// GB/T 7408-1994《数据元和交换格式·信息交换·日期和时间表示法》与ISO 8601:1988等效</span></span><br><span class="line">        dow: <span class="number">1</span>, <span class="comment">// Monday is the first day of the week.</span></span><br><span class="line">        doy: <span class="number">4</span> <span class="comment">// The week that contains Jan 4th is the first week of the year.</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> moment = momentDefault</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/56/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/56/">56</a><span class="page-number current">57</span><a class="page-number" href="/page/58/">58</a><span class="space">&hellip;</span><a class="page-number" href="/page/73/">73</a><a class="extend next" rel="next" href="/page/58/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Andy Ge</p>
  <div class="site-description" itemprop="description">勇于积极进取，步入人生的世外桃源</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">728</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">134</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">315</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/andyge" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;andyge" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:geshaofei@126.com" title="E-Mail → mailto:geshaofei@126.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.ruanyifeng.com/" title="http:&#x2F;&#x2F;www.ruanyifeng.com&#x2F;" rel="noopener" target="_blank">阮一峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://colobu.com/" title="http:&#x2F;&#x2F;colobu.com&#x2F;" rel="noopener" target="_blank">鸟窝</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/hellokuangshen/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;hellokuangshen&#x2F;" rel="noopener" target="_blank">狂神</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://yelog.org/" title="https:&#x2F;&#x2F;yelog.org&#x2F;" rel="noopener" target="_blank">叶落阁</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Andy Ge</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.1
  </div>

        






  <script>
  function leancloudSelector(url) {
    url = encodeURI(url);
    return document.getElementById(url).querySelector('.leancloud-visitors-count');
  }
  if (CONFIG.page.isPost) {
    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.getAttribute('id'));
      var title = visitors.getAttribute('data-flag-title');

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .then(response => response.json())
              .then(() => {
                leancloudSelector(url).innerText = counter.time + 1;
              })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              })
          } else {
              Counter('post', '/classes/Counter', { title: title, url: url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  } else {
    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.getAttribute('id'));
      });

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url: { '$in': entries } })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length === 0) {
            document.querySelectorAll('.leancloud_visitors .leancloud-visitors-count').forEach(element => {
              element.innerText = 0;
            });
            return;
          }
          for (let item of results) {
            let { url, time } = item;
            leancloudSelector(url).innerText = time;
          }
          for (let url of entries) {
            var element = leancloudSelector(url);
            if (element.innerText == '') {
              element.innerText = 0;
            }
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  }

  fetch('https://app-router.leancloud.cn/2/route?appId=2TdIb5gRlAVUw24l2W0zWnCj-gzGzoHsz')
    .then(response => response.json())
    .then(({ api_server }) => {
      var Counter = (method, url, data) => {
        return fetch(`https://${api_server}/1.1${url}`, {
          method: method,
          headers: {
            'X-LC-Id'     : '2TdIb5gRlAVUw24l2W0zWnCj-gzGzoHsz',
            'X-LC-Key'    : 'cJdJrMLBXsj0ttq0WsL0aA2j',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    });
  </script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
