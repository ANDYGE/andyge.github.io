<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"swiftist.cn","root":"/","scheme":"Pisces","version":"7.7.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"appID":"EVBR3H53HW","apiKey":"2abd573a01143a0cc4108fa4d21ae67c","indexName":"swiftist","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="勇于积极进取，步入人生的世外桃源">
<meta property="og:type" content="website">
<meta property="og:title" content="飞雪轩辕">
<meta property="og:url" content="https://swiftist.cn/page/40/index.html">
<meta property="og:site_name" content="飞雪轩辕">
<meta property="og:description" content="勇于积极进取，步入人生的世外桃源">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Andy Ge">
<meta property="article:tag" content="技术博客">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://swiftist.cn/page/40/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>飞雪轩辕</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="飞雪轩辕" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">飞雪轩辕</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">人生的乐趣在于把梦想变成现实</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-java">

    <a href="/categories/java/" rel="section"><i class="fa fa-fw fa-th-large"></i>java</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/03/02/mysql/%E8%AF%A6%E8%A7%A3mysql/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/02/mysql/%E8%AF%A6%E8%A7%A3mysql/" class="post-title-link" itemprop="url">详解mysql 获取当前日期及格式化</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-03-02 08:22:52" itemprop="dateCreated datePublished" datetime="2019-03-02T08:22:52+08:00">2019-03-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index">
                    <span itemprop="name">mysql</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/03/02/mysql/%E8%AF%A6%E8%A7%A3mysql/" class="post-meta-item leancloud_visitors" data-flag-title="详解mysql 获取当前日期及格式化" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="MySQL-获取当前日期及日期格式"><a href="#MySQL-获取当前日期及日期格式" class="headerlink" title="MySQL 获取当前日期及日期格式"></a>MySQL 获取当前日期及日期格式</h1><p>获取系统日期： NOW()</p>
<p>格式化日期： DATE_FORMAT(date, format)</p>
<p>注： date：时间字段</p>
<p>format：日期格式</p>
<p>返回系统日期,输出 2009-12-25 14:38:59</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">now</span>();</span><br></pre></td></tr></table></figure>

<p>输出 09-12-25</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">date_format</span>(<span class="keyword">now</span>(),<span class="string">'%y-%m-%d'</span>);</span><br></pre></td></tr></table></figure>

<p>根据 format 字符串格式化 date 值:</p>
<ul>
<li>%S, %s 两位数字形式的秒（ 00,01, …, 59）</li>
<li>%I, %i 两位数字形式的分（ 00,01, …, 59）</li>
<li>%H 两位数字形式的小时，24 小时（00,01, …, 23）</li>
<li>%h 两位数字形式的小时，12 小时（01,02, …, 12）</li>
<li>%k 数字形式的小时，24 小时（0,1, …, 23）</li>
<li>%l 数字形式的小时，12 小时（1, 2, …, 12）</li>
<li>%T 24 小时的时间形式（hh:mm:ss）</li>
<li>%r 12 小时的时间形式（hh:mm:ss AM 或 hh:mm:ss PM）</li>
<li>%p AM 或 PM</li>
<li>%W 一周中每一天的名称（Sunday, Monday, …, Saturday）</li>
<li>%a 一周中每一天名称的缩写（Sun, Mon, …, Sat）</li>
<li>%d 两位数字表示月中的天数（00, 01,…, 31）</li>
<li>%e 数字形式表示月中的天数（1, 2， …, 31）</li>
<li>%D 英文后缀表示月中的天数（1st, 2nd, 3rd,…）</li>
<li>%w 以数字形式表示周中的天数（ 0 = Sunday, 1=Monday, …, 6=Saturday）</li>
<li>%j 以三位数字表示年中的天数（ 001, 002, …, 366）</li>
<li>%U 周（0, 1, 52），其中 Sunday 为周中的第一天</li>
<li>%u 周（0, 1, 52），其中 Monday 为周中的第一天</li>
<li>%M 月名（January, February, …, December）</li>
<li>%b 缩写的月名（ January, February,…., December）</li>
<li>%m 两位数字表示的月份（01, 02, …, 12）</li>
<li>%c 数字表示的月份（1, 2, …., 12）</li>
<li>%Y 四位数字表示的年份</li>
<li>%y 两位数字表示的年份</li>
<li>%% 直接值“%”</li>
</ul>
<h1 id="MySQL-获得当前日期时间-函数"><a href="#MySQL-获得当前日期时间-函数" class="headerlink" title="MySQL 获得当前日期时间 函数"></a>MySQL 获得当前日期时间 函数</h1><h2 id="获得当前日期-时间（date-time）函数：now"><a href="#获得当前日期-时间（date-time）函数：now" class="headerlink" title="获得当前日期+时间（date + time）函数：now()"></a>获得当前日期+时间（date + time）函数：now()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select now();</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">| now() |</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">| 2008-08-08 22:20:46 |</span><br><span class="line">+<span class="comment">---------------------+</span></span><br></pre></td></tr></table></figure>

<p>除了 now() 函数能获得当前的日期时间外，MySQL 中还有下面的函数：</p>
<ol>
<li>current_timestamp()</li>
<li>,current_timestamp</li>
<li>,localtime()</li>
<li>,localtime</li>
<li>,localtimestamp – (v4.0.6)</li>
<li>,localtimestamp() – (v4.0.6)</li>
</ol>
<p>这些日期时间函数，都等同于 now()。鉴于 now() 函数简短易记，建议总是使用 now() 来替代上面列出的函数。</p>
<h2 id="获得当前日期-时间（date-time）函数：sysdate"><a href="#获得当前日期-时间（date-time）函数：sysdate" class="headerlink" title="获得当前日期+时间（date + time）函数：sysdate()"></a>获得当前日期+时间（date + time）函数：sysdate()</h2><p>sysdate() 日期时间函数跟 now() 类似，不同之处在于：now() 在执行开始时值就得到了， sysdate() 在函数执行时动态得到值。看下面的例子就明白了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select now(), sleep(3), now();</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------+----------+---------------------+</span></span><br><span class="line">| now() | sleep(3) | now() |</span><br><span class="line">+<span class="comment">---------------------+----------+---------------------+</span></span><br><span class="line">| 2008-08-08 22:28:21 | 0 | 2008-08-08 22:28:21 |</span><br><span class="line">+<span class="comment">---------------------+----------+---------------------+mysql&gt; select sysdate(), sleep(3), sysdate();</span></span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------+----------+---------------------+</span></span><br><span class="line">| sysdate() | sleep(3) | sysdate() |</span><br><span class="line">+<span class="comment">---------------------+----------+---------------------+</span></span><br><span class="line">| 2008-08-08 22:28:41 | 0 | 2008-08-08 22:28:44 |</span><br><span class="line">+<span class="comment">---------------------+----------+---------------------+</span></span><br></pre></td></tr></table></figure>

<p>可以看到，虽然中途 sleep 3 秒，但 now() 函数两次的时间值是相同的； sysdate() 函数两次得到的时间值相差 3 秒。MySQL Manual 中是这样描述 sysdate() 的：Return the time at which the functionexecutes。</p>
<p>sysdate() 日期时间函数，一般情况下很少用到。</p>
<h2 id="获得当前日期（date）函数：curdate"><a href="#获得当前日期（date）函数：curdate" class="headerlink" title="获得当前日期（date）函数：curdate()"></a>获得当前日期（date）函数：curdate()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select curdate();</span><br><span class="line"></span><br><span class="line">+<span class="comment">------------+</span></span><br><span class="line">| curdate() |</span><br><span class="line">+<span class="comment">------------+</span></span><br><span class="line">| 2008-08-08 |</span><br><span class="line">+<span class="comment">------------+</span></span><br></pre></td></tr></table></figure>

<p>其中，下面的两个日期函数等同于 curdate()：</p>
<p>current_date()</p>
<p>,current_date</p>
<h2 id="获得当前时间（time）函数：curtime"><a href="#获得当前时间（time）函数：curtime" class="headerlink" title="获得当前时间（time）函数：curtime()"></a>获得当前时间（time）函数：curtime()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select curtime();</span><br><span class="line"></span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| curtime() |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| 22:41:30 |</span><br><span class="line">+<span class="comment">-----------+</span></span><br></pre></td></tr></table></figure>

<p>其中，下面的两个时间函数等同于 curtime()：</p>
<p>current_time()</p>
<p>,current_time</p>
<h2 id="获得当前-UTC-日期时间函数：utc-date-utc-time-utc-timestamp"><a href="#获得当前-UTC-日期时间函数：utc-date-utc-time-utc-timestamp" class="headerlink" title="获得当前 UTC 日期时间函数：utc_date(), utc_time(), utc_timestamp()"></a>获得当前 UTC 日期时间函数：utc_date(), utc_time(), utc_timestamp()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select utc_timestamp(), utc_date(), utc_time(), now()</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------+------------+------------+---------------------+</span></span><br><span class="line">| utc_timestamp() | utc_date() | utc_time() | now() |</span><br><span class="line">+<span class="comment">---------------------+------------+------------+---------------------+</span></span><br><span class="line">| 2008-08-08 14:47:11 | 2008-08-08 | 14:47:11 | 2008-08-08 22:47:11 |</span><br><span class="line">+<span class="comment">---------------------+------------+------------+---------------------+</span></span><br></pre></td></tr></table></figure>

<p>因为我国位于东八时区，所以本地时间 = UTC 时间 + 8 小时。UTC 时间在业务涉及多个国家和地区的时候，非常有用。</p>
<h1 id="MySQL-日期时间-Extract（选取）-函数。"><a href="#MySQL-日期时间-Extract（选取）-函数。" class="headerlink" title="MySQL 日期时间 Extract（选取） 函数。"></a>MySQL 日期时间 Extract（选取） 函数。</h1><h2 id="选取日期时间的各个部分：日期、时间、年、季度、月、日、小时、分钟、秒、微秒"><a href="#选取日期时间的各个部分：日期、时间、年、季度、月、日、小时、分钟、秒、微秒" class="headerlink" title="选取日期时间的各个部分：日期、时间、年、季度、月、日、小时、分钟、秒、微秒"></a>选取日期时间的各个部分：日期、时间、年、季度、月、日、小时、分钟、秒、微秒</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @dt = <span class="string">'2008-09-10 07:15:30.123456'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">date</span>(@dt); <span class="comment">-- 2008-09-10</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">time</span>(@dt); <span class="comment">-- 07:15:30.123456</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">year</span>(@dt); <span class="comment">-- 2008</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">quarter</span>(@dt); <span class="comment">-- 3</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">month</span>(@dt); <span class="comment">-- 9</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">week</span>(@dt); <span class="comment">-- 36</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">day</span>(@dt); <span class="comment">-- 10</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">hour</span>(@dt); <span class="comment">-- 7</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">minute</span>(@dt); <span class="comment">-- 15</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">second</span>(@dt); <span class="comment">-- 30</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">microsecond</span>(@dt); <span class="comment">-- 123456</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-Extract-函数，可以上面实现类似的功能："><a href="#MySQL-Extract-函数，可以上面实现类似的功能：" class="headerlink" title="MySQL Extract() 函数，可以上面实现类似的功能："></a>MySQL Extract() 函数，可以上面实现类似的功能：</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @dt = <span class="string">'2008-09-10 07:15:30.123456'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">year</span> <span class="keyword">from</span> @dt); <span class="comment">-- 2008</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">quarter</span> <span class="keyword">from</span> @dt); <span class="comment">-- 3</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">month</span> <span class="keyword">from</span> @dt); <span class="comment">-- 9</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">week</span> <span class="keyword">from</span> @dt); <span class="comment">-- 36</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">day</span> <span class="keyword">from</span> @dt); <span class="comment">-- 10</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">hour</span> <span class="keyword">from</span> @dt); <span class="comment">-- 7</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">minute</span> <span class="keyword">from</span> @dt); <span class="comment">-- 15</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">second</span> <span class="keyword">from</span> @dt); <span class="comment">-- 30</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(<span class="keyword">microsecond</span> <span class="keyword">from</span> @dt); <span class="comment">-- 123456select extract(year_month from @dt); -- 200809</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(day_hour <span class="keyword">from</span> @dt); <span class="comment">-- 1007</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(day_minute <span class="keyword">from</span> @dt); <span class="comment">-- 100715</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(day_second <span class="keyword">from</span> @dt); <span class="comment">-- 10071530</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(day_microsecond <span class="keyword">from</span> @dt); <span class="comment">-- 10071530123456</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(hour_minute <span class="keyword">from</span> @dt); <span class="comment">-- 715</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(hour_second <span class="keyword">from</span> @dt); <span class="comment">-- 71530</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(hour_microsecond <span class="keyword">from</span> @dt); <span class="comment">-- 71530123456</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(minute_second <span class="keyword">from</span> @dt); <span class="comment">-- 1530</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(minute_microsecond <span class="keyword">from</span> @dt); <span class="comment">-- 1530123456</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">extract</span>(second_microsecond <span class="keyword">from</span> @dt); <span class="comment">-- 30123456</span></span><br></pre></td></tr></table></figure>

<p>MySQLExtract() 函数除了没有 date(),time() 的功能外，其他功能一应具全。并且还具有选取‘day_microsecond’等功能。注意这里不是只选取 day 和 microsecond，而是从日期的 day 部分一直选取到 microsecond 部分。够强悍的吧！</p>
<p>MySQL Extract() 函数唯一不好的地方在于：你需要多敲几次键盘。</p>
<h2 id="MySQL-dayof…-函数：dayofweek-dayofmonth-dayofyear"><a href="#MySQL-dayof…-函数：dayofweek-dayofmonth-dayofyear" class="headerlink" title="MySQL dayof… 函数：dayofweek(), dayofmonth(), dayofyear()"></a>MySQL dayof… 函数：dayofweek(), dayofmonth(), dayofyear()</h2><p>分别返回日期参数，在一周、一月、一年中的位置。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @dt = <span class="string">'2008-08-08'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">dayofweek</span>(@dt); <span class="comment">-- 6</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">dayofmonth</span>(@dt); <span class="comment">-- 8</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">dayofyear</span>(@dt); <span class="comment">-- 221</span></span><br></pre></td></tr></table></figure>

<p>日期 ‘2008-08-08′ 是一周中的第 6 天（1 = Sunday, 2 = Monday, …, 7 = Saturday）；一月中的第 8 天；一年中的第 221 天。</p>
<h2 id="MySQL-week…-函数：week-weekofyear-dayofweek-weekday-yearweek"><a href="#MySQL-week…-函数：week-weekofyear-dayofweek-weekday-yearweek" class="headerlink" title="MySQL week… 函数：week(), weekofyear(), dayofweek(), weekday(), yearweek()"></a>MySQL week… 函数：week(), weekofyear(), dayofweek(), weekday(), yearweek()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @dt = <span class="string">'2008-08-08'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">week</span>(@dt); <span class="comment">-- 31</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">week</span>(@dt,<span class="number">3</span>); <span class="comment">-- 32</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">weekofyear</span>(@dt); <span class="comment">-- 32</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">dayofweek</span>(@dt); <span class="comment">-- 6</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">weekday</span>(@dt); <span class="comment">-- 4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">yearweek</span>(@dt); <span class="comment">-- 200831</span></span><br></pre></td></tr></table></figure>

<p>MySQL week() 函数，可以有两个参数，具体可看手册。 weekofyear() 和 week() 一样，都是计算“某天”是位于一年中的第几周。 weekofyear(@dt) 等价于 week(@dt,3)。</p>
<p>MySQLweekday() 函数和 dayofweek() 类似，都是返回“某天”在一周中的位置。不同点在于参考的标准， weekday：(0 =Monday, 1 = Tuesday, …, 6 = Sunday)； dayofweek：（1 = Sunday, 2 = Monday,…, 7 = Saturday）</p>
<p>MySQL yearweek() 函数，返回 year(2008) + week 位置(31)。</p>
<h2 id="MySQL-返回星期和月份名称函数：dayname-monthname"><a href="#MySQL-返回星期和月份名称函数：dayname-monthname" class="headerlink" title="MySQL 返回星期和月份名称函数：dayname(), monthname()"></a>MySQL 返回星期和月份名称函数：dayname(), monthname()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @dt = <span class="string">'2008-08-08'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">dayname</span>(@dt); <span class="comment">-- Friday</span></span><br><span class="line"><span class="keyword">select</span> monthname(@dt); <span class="comment">-- August</span></span><br></pre></td></tr></table></figure>

<p>思考，如何返回中文的名称呢？</p>
<h2 id="MySQL-last-day-函数：返回月份中的最后一天。"><a href="#MySQL-last-day-函数：返回月份中的最后一天。" class="headerlink" title="MySQL last_day() 函数：返回月份中的最后一天。"></a>MySQL last_day() 函数：返回月份中的最后一天。</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">last_day</span>(<span class="string">'2008-02-01'</span>); <span class="comment">-- 2008-02-29</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">last_day</span>(<span class="string">'2008-08-08'</span>); <span class="comment">-- 2008-08-31</span></span><br></pre></td></tr></table></figure>

<p>MySQL last_day() 函数非常有用，比如我想得到当前月份中有多少天，可以这样来计算：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select now(), day(last_day(now())) as days;</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------+------+</span></span><br><span class="line">| now() | days |</span><br><span class="line">+<span class="comment">---------------------+------+</span></span><br><span class="line">| 2008-08-09 11:45:45 | 31 |</span><br><span class="line">+<span class="comment">---------------------+------+</span></span><br></pre></td></tr></table></figure>

<h1 id="MySQL-日期时间计算函数"><a href="#MySQL-日期时间计算函数" class="headerlink" title="MySQL 日期时间计算函数"></a>MySQL 日期时间计算函数</h1><h2 id="MySQL-为日期增加一个时间间隔：date-add"><a href="#MySQL-为日期增加一个时间间隔：date-add" class="headerlink" title="MySQL 为日期增加一个时间间隔：date_add()"></a>MySQL 为日期增加一个时间间隔：date_add()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> @dt = <span class="keyword">now</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">day</span>); <span class="comment">-- add 1 day</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">hour</span>); <span class="comment">-- add 1 hour</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">minute</span>); <span class="comment">-- ...</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">second</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">microsecond</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">week</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">month</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">quarter</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">year</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(@dt, <span class="built_in">interval</span> <span class="number">-1</span> <span class="keyword">day</span>); <span class="comment">-- sub 1 day</span></span><br></pre></td></tr></table></figure>

<p>MySQL adddate(), addtime()函数，可以用 date_add() 来替代。下面是 date_add() 实现 addtime() 功能示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set @dt = '2008-08-09 12:12:33';</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line">mysql&gt; select date_add(@dt, interval '01:15:30' hour_second);</span><br><span class="line"></span><br><span class="line">+<span class="comment">------------------------------------------------+</span></span><br><span class="line">| date_add(@dt, interval '01:15:30' hour_second) |</span><br><span class="line">+<span class="comment">------------------------------------------------+</span></span><br><span class="line">| 2008-08-09 13:28:03 |</span><br><span class="line">+<span class="comment">------------------------------------------------+mysql&gt; select date_add(@dt, interval '1 01:15:30' day_second);</span></span><br><span class="line"></span><br><span class="line">+<span class="comment">-------------------------------------------------+</span></span><br><span class="line">| date_add(@dt, interval '1 01:15:30' day_second) |</span><br><span class="line">+<span class="comment">-------------------------------------------------+</span></span><br><span class="line">| 2008-08-10 13:28:03 |</span><br><span class="line">+<span class="comment">-------------------------------------------------+</span></span><br></pre></td></tr></table></figure>

<p>date_add() 函数，分别为 @dt 增加了“1 小时 15 分 30 秒” 和 “1 天 1 小时 15 分 30 秒”。建议：总是使用 date_add() 日期时间函数来替代 adddate(), addtime()。</p>
<h2 id="MySQL-为日期减去一个时间间隔：date-sub"><a href="#MySQL-为日期减去一个时间间隔：date-sub" class="headerlink" title="MySQL 为日期减去一个时间间隔：date_sub()"></a>MySQL 为日期减去一个时间间隔：date_sub()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select date_sub('1998-01-01 00:00:00', interval '1 1:1:1' day_second);</span><br><span class="line"></span><br><span class="line">+<span class="comment">----------------------------------------------------------------+</span></span><br><span class="line">| date_sub('1998-01-01 00:00:00', interval '1 1:1:1' day_second) |</span><br><span class="line">+<span class="comment">----------------------------------------------------------------+</span></span><br><span class="line">| 1997-12-30 22:58:59 |</span><br><span class="line">+<span class="comment">----------------------------------------------------------------+</span></span><br></pre></td></tr></table></figure>

<p>MySQL date_sub() 日期时间函数 和 date_add() 用法一致，不再赘述。另外，MySQL 中还有两个函数 subdate(), subtime()，建议，用 date_sub() 来替代。</p>
<h2 id="MySQL-另类日期函数：period-add-P-N-period-diff-P1-P2"><a href="#MySQL-另类日期函数：period-add-P-N-period-diff-P1-P2" class="headerlink" title="MySQL 另类日期函数：period_add(P,N), period_diff(P1,P2)"></a>MySQL 另类日期函数：period_add(P,N), period_diff(P1,P2)</h2><p>函数参数“P” 的格式为“YYYYMM” 或者 “YYMM”，第二个参数“N” 表示增加或减去 N month（月）。</p>
<p>MySQL period_add(P,N)：日期加/减去 N 月。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select period_add(200808,2), period_add(20080808,-2)</span><br><span class="line"></span><br><span class="line">+<span class="comment">----------------------+-------------------------+</span></span><br><span class="line">| period_add(200808,2) | period_add(20080808,-2) |</span><br><span class="line">+<span class="comment">----------------------+-------------------------+</span></span><br><span class="line">| 200810 | 20080806 |</span><br><span class="line">+<span class="comment">----------------------+-------------------------+</span></span><br><span class="line">MySQL period_diff(P1,P2)：日期 P1-P2，返回 N 个月。</span><br><span class="line"></span><br><span class="line">mysql&gt; select period_diff(200808, 200801);</span><br><span class="line"></span><br><span class="line">+<span class="comment">-----------------------------+</span></span><br><span class="line">| period_diff(200808, 200801) |</span><br><span class="line">+<span class="comment">-----------------------------+</span></span><br><span class="line">| 7 |</span><br><span class="line">+<span class="comment">-----------------------------+</span></span><br></pre></td></tr></table></figure>

<p>在 MySQL 中，这两个日期函数，一般情况下很少用到。</p>
<h2 id="MySQL-日期、时间相减函数：datediff-date1-date2-timediff-time1-time2"><a href="#MySQL-日期、时间相减函数：datediff-date1-date2-timediff-time1-time2" class="headerlink" title="MySQL 日期、时间相减函数：datediff(date1,date2), timediff(time1,time2)"></a>MySQL 日期、时间相减函数：datediff(date1,date2), timediff(time1,time2)</h2><p>MySQL datediff(date1,date2)：两个日期相减 date1 - date2，返回天数。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">datediff</span>(<span class="string">'2008-08-08'</span>, <span class="string">'2008-08-01'</span>); <span class="comment">-- 7</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">datediff</span>(<span class="string">'2008-08-01'</span>, <span class="string">'2008-08-08'</span>); <span class="comment">-- -7</span></span><br></pre></td></tr></table></figure>

<p>MySQL timediff(time1,time2)：两个日期相减 time1 - time2，返回 time 差值。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">timediff</span>(<span class="string">'2008-08-08 08:08:08'</span>, <span class="string">'2008-08-08 00:00:00'</span>); <span class="comment">-- 08:08:08</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">timediff</span>(<span class="string">'08:08:08'</span>, <span class="string">'00:00:00'</span>); <span class="comment">-- 08:08:08</span></span><br></pre></td></tr></table></figure>

<p>注意：timediff(time1,time2) 函数的两个参数类型必须相同。</p>
<h1 id="MySQL-日期转换函数、时间转换函数"><a href="#MySQL-日期转换函数、时间转换函数" class="headerlink" title="MySQL 日期转换函数、时间转换函数"></a>MySQL 日期转换函数、时间转换函数</h1><h2 id="MySQL-（时间、秒）转换函数：time-to-sec-time-sec-to-time-seconds"><a href="#MySQL-（时间、秒）转换函数：time-to-sec-time-sec-to-time-seconds" class="headerlink" title="MySQL （时间、秒）转换函数：time_to_sec(time), sec_to_time(seconds)"></a>MySQL （时间、秒）转换函数：time_to_sec(time), sec_to_time(seconds)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> time_to_sec(<span class="string">'01:00:05'</span>); <span class="comment">-- 3605</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">sec_to_time</span>(<span class="number">3605</span>); <span class="comment">-- '01:00:05'</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-（日期、天数）转换函数：to-days-date-from-days-days"><a href="#MySQL-（日期、天数）转换函数：to-days-date-from-days-days" class="headerlink" title="MySQL （日期、天数）转换函数：to_days(date), from_days(days)"></a>MySQL （日期、天数）转换函数：to_days(date), from_days(days)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">to_days</span>(<span class="string">'0000-00-00'</span>); <span class="comment">-- 0</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">to_days</span>(<span class="string">'2008-08-08'</span>); <span class="comment">-- 733627</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">from_days</span>(<span class="number">0</span>); <span class="comment">-- '0000-00-00'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">from_days</span>(<span class="number">733627</span>); <span class="comment">-- '2008-08-08'</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-Str-to-Date-（字符串转换为日期）函数：str-to-date-str-format"><a href="#MySQL-Str-to-Date-（字符串转换为日期）函数：str-to-date-str-format" class="headerlink" title="MySQL Str to Date （字符串转换为日期）函数：str_to_date(str, format)"></a>MySQL Str to Date （字符串转换为日期）函数：str_to_date(str, format)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'08/09/2008'</span>, <span class="string">'%m/%d/%Y'</span>); <span class="comment">-- 2008-08-09</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'08/09/08'</span> , <span class="string">'%m/%d/%y'</span>); <span class="comment">-- 2008-08-09</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'08.09.2008'</span>, <span class="string">'%m.%d.%Y'</span>); <span class="comment">-- 2008-08-09</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'08:09:30'</span>, <span class="string">'%h:%i:%s'</span>); <span class="comment">-- 08:09:30</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">str_to_date</span>(<span class="string">'08.09.2008 08:09:30'</span>, <span class="string">'%m.%d.%Y %h:%i:%s'</span>); <span class="comment">-- 2008-08-09 08:09:30</span></span><br></pre></td></tr></table></figure>

<p>可以看到，str_to_date(str,format) 转换函数，可以把一些杂乱无章的字符串转换为日期格式。另外，它也可以转换为时间。“format” 可以参看 MySQL 手册。</p>
<h2 id="MySQL-Date-Time-to-Str（日期-时间转换为字符串）函数：date-format-date-format-time-format-time-format"><a href="#MySQL-Date-Time-to-Str（日期-时间转换为字符串）函数：date-format-date-format-time-format-time-format" class="headerlink" title="MySQL Date/Time to Str（日期/时间转换为字符串）函数：date_format(date,format), time_format(time,format)"></a>MySQL Date/Time to Str（日期/时间转换为字符串）函数：date_format(date,format), time_format(time,format)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select date_format('2008-08-08 22:23:00', '%W %M %Y');</span><br><span class="line"></span><br><span class="line">+<span class="comment">------------------------------------------------+</span></span><br><span class="line">| date_format('2008-08-08 22:23:00', '%W %M %Y') |</span><br><span class="line">+<span class="comment">------------------------------------------------+</span></span><br><span class="line">| Friday August 2008 |</span><br><span class="line">+<span class="comment">------------------------------------------------+mysql&gt; select date_format('2008-08-08 22:23:01', '%Y%m%d%H%i%s');</span></span><br><span class="line"></span><br><span class="line">+<span class="comment">----------------------------------------------------+</span></span><br><span class="line">| date_format('2008-08-08 22:23:01', '%Y%m%d%H%i%s') |</span><br><span class="line">+<span class="comment">----------------------------------------------------+</span></span><br><span class="line">| 20080808222301 |</span><br><span class="line">+<span class="comment">----------------------------------------------------+mysql&gt; select time_format('22:23:01', '%H.%i.%s');</span></span><br><span class="line"></span><br><span class="line">+<span class="comment">-------------------------------------+</span></span><br><span class="line">| time_format('22:23:01', '%H.%i.%s') |</span><br><span class="line">+<span class="comment">-------------------------------------+</span></span><br><span class="line">| 22.23.01 |</span><br><span class="line">+<span class="comment">-------------------------------------+</span></span><br></pre></td></tr></table></figure>

<p>MySQL 日期、时间转换函数：date_format(date,format), time_format(time,format) 能够把一个日期/时间转换成各种各样的字符串格式。它是 str_to_date(str,format) 函数的 一个逆转换。</p>
<h2 id="MySQL-获得国家地区时间格式函数：get-format"><a href="#MySQL-获得国家地区时间格式函数：get-format" class="headerlink" title="MySQL 获得国家地区时间格式函数：get_format()"></a>MySQL 获得国家地区时间格式函数：get_format()</h2><p>MySQL get_format() 语法：</p>
<p>get_format(date|time|datetime, ‘eur’|’usa’|’jis’|’iso’|’internal’</p>
<p>MySQL get_format() 用法的全部示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">date</span>,<span class="string">'usa'</span>) ; <span class="comment">-- '%m.%d.%Y'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">date</span>,<span class="string">'jis'</span>) ; <span class="comment">-- '%Y-%m-%d'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">date</span>,<span class="string">'iso'</span>) ; <span class="comment">-- '%Y-%m-%d'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">date</span>,<span class="string">'eur'</span>) ; <span class="comment">-- '%d.%m.%Y'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">date</span>,<span class="string">'internal'</span>) ; <span class="comment">-- '%Y%m%d'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(datetime,<span class="string">'usa'</span>) ; <span class="comment">-- '%Y-%m-%d %H.%i.%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(datetime,<span class="string">'jis'</span>) ; <span class="comment">-- '%Y-%m-%d %H:%i:%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(datetime,<span class="string">'iso'</span>) ; <span class="comment">-- '%Y-%m-%d %H:%i:%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(datetime,<span class="string">'eur'</span>) ; <span class="comment">-- '%Y-%m-%d %H.%i.%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(datetime,<span class="string">'internal'</span>) ; <span class="comment">-- '%Y%m%d%H%i%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">time</span>,<span class="string">'usa'</span>) ; <span class="comment">-- '%h:%i:%s %p'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">time</span>,<span class="string">'jis'</span>) ; <span class="comment">-- '%H:%i:%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">time</span>,<span class="string">'iso'</span>) ; <span class="comment">-- '%H:%i:%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">time</span>,<span class="string">'eur'</span>) ; <span class="comment">-- '%H.%i.%s'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">get_format</span>(<span class="built_in">time</span>,<span class="string">'internal'</span>) ; <span class="comment">-- '%H%i%s'</span></span><br></pre></td></tr></table></figure>

<p>MySQL get_format() 函数在实际中用到机会的比较少。</p>
<h2 id="MySQL-拼凑日期、时间函数：makedate-year-dayofyear-maketime-hour-minute-second"><a href="#MySQL-拼凑日期、时间函数：makedate-year-dayofyear-maketime-hour-minute-second" class="headerlink" title="MySQL 拼凑日期、时间函数：makedate(year,dayofyear), maketime(hour,minute,second)"></a>MySQL 拼凑日期、时间函数：makedate(year,dayofyear), maketime(hour,minute,second)</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">makedate</span>(<span class="number">2001</span>,<span class="number">31</span>); <span class="comment">-- '2001-01-31'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">makedate</span>(<span class="number">2001</span>,<span class="number">32</span>); <span class="comment">-- '2001-02-01'</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">maketime</span>(<span class="number">12</span>,<span class="number">15</span>,<span class="number">30</span>); <span class="comment">-- '12:15:30'</span></span><br></pre></td></tr></table></figure>

<h1 id="MySQL-时间戳（Timestamp）函数"><a href="#MySQL-时间戳（Timestamp）函数" class="headerlink" title="MySQL 时间戳（Timestamp）函数"></a>MySQL 时间戳（Timestamp）函数</h1><h2 id="MySQL-获得当前时间戳函数：current-timestamp-current-timestamp"><a href="#MySQL-获得当前时间戳函数：current-timestamp-current-timestamp" class="headerlink" title="MySQL 获得当前时间戳函数：current_timestamp, current_timestamp()"></a>MySQL 获得当前时间戳函数：current_timestamp, current_timestamp()</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select current_timestamp, current_timestamp();</span><br><span class="line"></span><br><span class="line">+<span class="comment">---------------------+---------------------+</span></span><br><span class="line">| current_timestamp | current_timestamp() |</span><br><span class="line">+<span class="comment">---------------------+---------------------+</span></span><br><span class="line">| 2008-08-09 23:22:24 | 2008-08-09 23:22:24 |</span><br><span class="line">+<span class="comment">---------------------+---------------------+</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-（Unix-时间戳、日期）转换函数："><a href="#MySQL-（Unix-时间戳、日期）转换函数：" class="headerlink" title="MySQL （Unix 时间戳、日期）转换函数："></a>MySQL （Unix 时间戳、日期）转换函数：</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">unix_timestamp(),</span><br><span class="line">unix_timestamp(date),</span><br><span class="line">from_unixtime(unix_timestamp),</span><br><span class="line">from_unixtime(unix_timestamp,format)</span><br></pre></td></tr></table></figure>

<p>下面是示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">unix_timestamp</span>(); <span class="comment">-- 1218290027</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">unix_timestamp</span>(<span class="string">'2008-08-08'</span>); <span class="comment">-- 1218124800</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">unix_timestamp</span>(<span class="string">'2008-08-08 12:30:00'</span>); <span class="comment">-- 1218169800</span></span><br><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1218290027</span>); <span class="comment">-- '2008-08-09 21:53:47'</span></span><br><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1218124800</span>); <span class="comment">-- '2008-08-08 00:00:00'</span></span><br><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1218169800</span>); <span class="comment">-- '2008-08-08 12:30:00'</span></span><br><span class="line"><span class="keyword">select</span> from_unixtime(<span class="number">1218169800</span>, <span class="string">'%Y %D %M %h:%i:%s %x'</span>); <span class="comment">-- '2008 8th August12:30:00 2008'</span></span><br></pre></td></tr></table></figure>

<h2 id="MySQL-时间戳（timestamp）转换、增、减函数："><a href="#MySQL-时间戳（timestamp）转换、增、减函数：" class="headerlink" title="MySQL 时间戳（timestamp）转换、增、减函数："></a>MySQL 时间戳（timestamp）转换、增、减函数：</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">timestamp(date) <span class="comment">-- date to timestamp</span></span><br><span class="line">timestamp(dt,time) <span class="comment">-- dt + time</span></span><br><span class="line">timestampadd(unit,interval,datetime_expr) <span class="comment">--</span></span><br><span class="line">timestampdiff(unit,datetime_expr1,datetime_expr2) <span class="comment">--</span></span><br></pre></td></tr></table></figure>

<p>请看示例部分：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span>(<span class="string">'2008-08-08'</span>); <span class="comment">-- 2008-08-08 00:00:00</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span>(<span class="string">'2008-08-08 08:00:00'</span>, <span class="string">'01:01:01'</span>); <span class="comment">-- 2008-08-08 09:01:01</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">timestamp</span>(<span class="string">'2008-08-08 08:00:00'</span>, <span class="string">'10 01:01:01'</span>); <span class="comment">-- 2008-08-1809:01:01</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">timestampadd</span>(<span class="keyword">day</span>, <span class="number">1</span>, <span class="string">'2008-08-08 08:00:00'</span>); <span class="comment">--2008-08-09 08:00:00</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(<span class="string">'2008-08-08 08:00:00'</span>, <span class="built_in">interval</span> <span class="number">1</span> <span class="keyword">day</span>); <span class="comment">-- 2008-08-09 08:00:00</span></span><br></pre></td></tr></table></figure>

<p>MySQL timestampadd() 函数类似于 date_add()。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">timestampdiff</span>(<span class="keyword">year</span>,<span class="string">'2002-05-01'</span>,<span class="string">'2001-01-01'</span>); <span class="comment">-- -1</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">timestampdiff</span>(<span class="keyword">day</span> ,<span class="string">'2002-05-01'</span>,<span class="string">'2001-01-01'</span>); <span class="comment">-- -485</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">timestampdiff</span>(<span class="keyword">hour</span>,<span class="string">'2008-08-08 12:00:00'</span>,<span class="string">'2008-08-08 00:00:00'</span>); <span class="comment">-- -12</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">datediff</span>(<span class="string">'2008-08-08 12:00:00'</span>, <span class="string">'2008-08-01 00:00:00'</span>); <span class="comment">-- 7</span></span><br></pre></td></tr></table></figure>

<p>MySQL timestampdiff() 函数就比 datediff() 功能强多了，datediff() 只能计算两个日期（date）之间相差的天数。</p>
<h1 id="MySQL-时区（timezone）转换函数-convert-tz-dt-from-tz-to-tz"><a href="#MySQL-时区（timezone）转换函数-convert-tz-dt-from-tz-to-tz" class="headerlink" title="MySQL 时区（timezone）转换函数 convert_tz(dt,from_tz,to_tz)"></a>MySQL 时区（timezone）转换函数 convert_tz(dt,from_tz,to_tz)</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">convert_tz</span>(<span class="string">'2008-08-08 12:00:00'</span>, <span class="string">'+08:00'</span>, <span class="string">'+00:00'</span>); <span class="comment">-- 2008-08-0804:00:00</span></span><br></pre></td></tr></table></figure>

<p>时区转换也可以通过 date_add, date_sub, timestampadd 来实现。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">date_add</span>(<span class="string">'2008-08-08 12:00:00'</span>, <span class="built_in">interval</span> <span class="number">-8</span> <span class="keyword">hour</span>); <span class="comment">-- 2008-08-08 04:00:00</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">date_sub</span>(<span class="string">'2008-08-08 12:00:00'</span>, <span class="built_in">interval</span> <span class="number">8</span> <span class="keyword">hour</span>); <span class="comment">-- 2008-08-08 04:00:00</span></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">timestampadd</span>(<span class="keyword">hour</span>, <span class="number">-8</span>, <span class="string">'2008-08-08 12:00:00'</span>); <span class="comment">-- 2008-08-08 04:00:00</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/03/01/myBatis/MyBatis%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%80%BCMap%E6%88%96List-Map/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/03/01/myBatis/MyBatis%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%80%BCMap%E6%88%96List-Map/" class="post-title-link" itemprop="url">MyBatis查询，返回值Map或List<Map></a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-03-01 21:07:55" itemprop="dateCreated datePublished" datetime="2019-03-01T21:07:55+08:00">2019-03-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/03/01/myBatis/MyBatis%E6%9F%A5%E8%AF%A2%E8%BF%94%E5%9B%9E%E5%80%BCMap%E6%88%96List-Map/" class="post-meta-item leancloud_visitors" data-flag-title="MyBatis查询，返回值Map或List<Map>" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>mybatis 很聪明，如果只返回一条记录，接口返回的结果为 Map 对象，如果返回多条的话，则返回 <code>List&lt;Map&gt;</code>对象，示例如下：</p>
<p>一、返回值 Map</p>
<p>1、mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserMapLimitOne"</span> <span class="attr">resultType</span>=<span class="string">"java.util.HashMap"</span>&gt;</span></span><br><span class="line">select id,name</span><br><span class="line">from</span><br><span class="line">user order by id desc limit 1</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、接口定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取仅含一个的map（map的size=字段个数）</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function">Map&lt;String,Object&gt; <span class="title">selectUserMapLimitOne</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p>二、返回值 <code>List&lt;Map&gt;</code></p>
<p>1、mapper.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectUserMapList"</span> <span class="attr">resultType</span>=<span class="string">"java.util.HashMap"</span>&gt;</span></span><br><span class="line">select id,name from</span><br><span class="line">user order by id desc limit 2</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2、接口定义</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取map list</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">List&lt;Map&lt;String,Object&gt;&gt; selectUserMapList();</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/28/wx/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%A1%A8%E6%A0%BC%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/28/wx/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%A1%A8%E6%A0%BC%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">微信小程序表格实现</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-28 09:01:04" itemprop="dateCreated datePublished" datetime="2019-02-28T09:01:04+08:00">2019-02-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wxapp/" itemprop="url" rel="index">
                    <span itemprop="name">wxapp</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/28/wx/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E8%A1%A8%E6%A0%BC%E5%AE%9E%E7%8E%B0/" class="post-meta-item leancloud_visitors" data-flag-title="微信小程序表格实现" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-规格表格实现"><a href="#1-规格表格实现" class="headerlink" title="1. 规格表格实现"></a>1. 规格表格实现</h1><p>宽度可按百分比指定，通过 flex 实现，要注意的是 align-items 属性定义项目在交叉轴上如何对齐，stretch 是其默认值，如果项目未设置高度或设为 auto，将占满整个容器的高度，所以右边边框能够完全绘制，代码如下：</p>
<h2 id="1-1-table-less"><a href="#1-1-table-less" class="headerlink" title="1.1. table.less"></a>1.1. table.less</h2><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.table</span> &#123;</span><br><span class="line">    <span class="variable">@border:</span> <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="variable">@border</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#666</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">36</span>rpx;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">6</span>rpx;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">90%</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="selector-class">.tr</span> &#123;</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">flex-direction</span>: row;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="selector-tag">&amp;</span><span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">            <span class="selector-class">.td</span> &#123;</span><br><span class="line">                <span class="attribute">border-bottom-width</span>: <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.td</span>,</span><br><span class="line">        <span class="selector-class">.th</span> &#123;</span><br><span class="line">            <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">            <span class="attribute">border-right</span>: <span class="variable">@border</span>;</span><br><span class="line">            <span class="attribute">border-bottom</span>: <span class="variable">@border</span>;</span><br><span class="line">            <span class="attribute">padding</span>: <span class="number">10</span>rpx;</span><br><span class="line">            <span class="selector-tag">&amp;</span><span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">                <span class="attribute">border-right-width</span>: <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="selector-class">.th</span> &#123;</span><br><span class="line">            <span class="attribute">font-weight</span>: bold;</span><br><span class="line">            <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">            <span class="attribute">line-height</span>: <span class="number">50</span>rpx;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-2-页面"><a href="#1-2-页面" class="headerlink" title="1.2. 页面"></a>1.2. 页面</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"less"</span> <span class="attr">scoped</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="keyword">@import</span> <span class="string">'../weui/page.wxss'</span>;</span></span><br><span class="line"><span class="css">    <span class="keyword">@import</span> <span class="string">'../styles/table'</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.table</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="selector-class">.tr</span> &#123;</span></span><br><span class="line"><span class="css">            <span class="selector-class">.td</span>,</span></span><br><span class="line"><span class="css">            <span class="selector-class">.th</span> &#123;</span></span><br><span class="line"><span class="css">                &amp;<span class="selector-pseudo">:first-child</span> &#123;</span></span><br><span class="line"><span class="css">                    <span class="selector-tag">flex</span>: 0<span class="selector-class">.5</span>;</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page__hd"</span> <span class="attr">style</span>=<span class="string">"width:90%;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page__title"</span> <span class="attr">style</span>=<span class="string">"font-size:34rpx;"</span>&gt;</span>问诊问卷<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page__desc"</span>&gt;</span>数据由调查问卷获得<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span>&gt;</span>问题<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span>&gt;</span>答案<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>疾病史<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;ill&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;isAdult&#125;&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>工作环境<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;env&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span> <span class="attr">wx:else</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>座位位置<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;seat&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>玩电子游戏频率<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;game&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>运动习惯<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;sport&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;isAdult&#125;&#125;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>开车频率<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;drive&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>此次配镜用途<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>&#123;&#123;reason&#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">tap</span>=<span class="string">"back"</span> <span class="attr">style</span>=<span class="string">"width:90%;margin-top:60rpx;"</span>&gt;</span>返回<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> wepy <span class="keyword">from</span> <span class="string">'wepy'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> &#123; ills, seats, envs, games, sports, drives, reasons &#125; <span class="keyword">from</span> <span class="string">'../utils'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">wepy</span>.<span class="title">page</span> </span>&#123;</span></span><br><span class="line">        data = &#123;</span><br><span class="line"><span class="actionscript">            ill: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">            seat: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">            env: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">            game: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">            sport: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">            drive: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">            reason: <span class="string">''</span></span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        methods = &#123;</span><br><span class="line">            back() &#123;</span><br><span class="line">                wx.navigateBack(&#123; delta: 1 &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">        onLoad(&#123; data = <span class="string">'&#123;&#125;'</span>, isAdult = <span class="literal">false</span> &#125;) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">const</span> &#123; ill, seat, env, game, sport, drive, reason &#125; = <span class="built_in">JSON</span>.parse(</span></span><br><span class="line"><span class="javascript">                <span class="built_in">decodeURIComponent</span>(data)</span></span><br><span class="line">            )</span><br><span class="line">            if (ill &amp; 1) &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.ill = <span class="string">'无'</span></span></span><br><span class="line"><span class="actionscript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.ill = ills</span></span><br><span class="line"><span class="javascript">                    .filter(<span class="function"><span class="params">i</span> =&gt;</span> i.value &amp; ill)</span></span><br><span class="line"><span class="javascript">                    .map(<span class="function"><span class="params">i</span> =&gt;</span> i.label)</span></span><br><span class="line"><span class="actionscript">                    .join(<span class="string">'，'</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.seat = seats[seat]</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.env = envs[env]</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.game = games[game]</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.sport = sports[sport]</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.drive = drives[drive]</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.reason = reasons</span></span><br><span class="line"><span class="javascript">                .filter(<span class="function"><span class="params">r</span> =&gt;</span> r.value &amp; reason)</span></span><br><span class="line"><span class="javascript">                .map(<span class="function"><span class="params">r</span> =&gt;</span> r.label)</span></span><br><span class="line"><span class="actionscript">                .join(<span class="string">'，'</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-3-效果图"><a href="#1-3-效果图" class="headerlink" title="1.3. 效果图"></a>1.3. 效果图</h2><p><img src="/images/owl/WX20190228-180703@2x.png" alt="截图"></p>
<h1 id="2-合并表头实现"><a href="#2-合并表头实现" class="headerlink" title="2. 合并表头实现"></a>2. 合并表头实现</h1><p>指定宽度，单位采用 px，box-sizing 采用 border-box，指定表格像素实现，代码如下：</p>
<h2 id="2-1-实现代码"><a href="#2-1-实现代码" class="headerlink" title="2.1. 实现代码"></a>2.1. 实现代码</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">"less"</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="keyword">@import</span> <span class="string">'../weui/page.wxss'</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.table</span> &#123;</span></span><br><span class="line">        // 所有元素均采用view实现，为了能够准确对齐，</span><br><span class="line">        // 所以宽度是包括边框的宽度，故box-sizing采用border-box</span><br><span class="line">        &amp;,</span><br><span class="line">        view &#123;</span><br><span class="line">            box-sizing: border-box;</span><br><span class="line">        &#125;</span><br><span class="line">        @border: 1px solid #ccc;</span><br><span class="line">        // 这个宽度是表格除去边框的内容宽度</span><br><span class="line">        @width: 360px;</span><br><span class="line">        // 每个单元格的宽度，每行总共是5个单元格</span><br><span class="line">        @cellWidth: @width / 5;</span><br><span class="line">        // 表格的宽度要包括它的左右边框宽度</span><br><span class="line"><span class="css">        <span class="selector-tag">width</span>: <span class="keyword">@width</span>+2;</span></span><br><span class="line">        // 表格提供边框，这样圆角才会自然</span><br><span class="line"><span class="css">        <span class="selector-tag">border</span>: <span class="keyword">@border</span>;</span></span><br><span class="line">        border-radius: 3px;</span><br><span class="line">        font-size: 12px;</span><br><span class="line">        text-align: center;</span><br><span class="line"><span class="css">        <span class="selector-class">.tr</span> &#123;</span></span><br><span class="line">            display: flex;</span><br><span class="line"><span class="css">            <span class="selector-class">.twoCell</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">width</span>: <span class="keyword">@cellWidth</span>*2 !important;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.fourCell</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">width</span>: <span class="keyword">@cellWidth</span>*4 !important;</span></span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.td</span>,</span></span><br><span class="line"><span class="css">            <span class="selector-class">.th</span> &#123;</span></span><br><span class="line">                padding: 5px;</span><br><span class="line"><span class="css">                <span class="selector-tag">width</span>: <span class="keyword">@cellWidth</span>;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">border-right</span>: <span class="keyword">@border</span>;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">border-bottom</span>: <span class="keyword">@border</span>;</span></span><br><span class="line">                // 每行的最后一个单元格不需要右边框</span><br><span class="line"><span class="css">                &amp;<span class="selector-pseudo">:last-child</span> &#123;</span></span><br><span class="line">                    border-right-width: 0;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"><span class="css">            <span class="selector-class">.th</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-tag">background-color</span>: <span class="selector-id">#eee</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">            // 表格最后一行及表头第二行的单元格不需要下边框</span><br><span class="line"><span class="css">            &amp;<span class="selector-pseudo">:last-child</span>,</span></span><br><span class="line"><span class="css">            <span class="selector-class">.noBottom</span> &#123;</span></span><br><span class="line"><span class="css">                <span class="selector-class">.td</span>,</span></span><br><span class="line"><span class="css">                <span class="selector-class">.th</span> &#123;</span></span><br><span class="line">                    border-bottom-width: 0;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page__hd"</span> <span class="attr">style</span>=<span class="string">"width:360px;padding:10px 0;"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page__title"</span> <span class="attr">style</span>=<span class="string">"font-size:34rpx;"</span>&gt;</span>验光数据<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"page__desc"</span>&gt;</span>请完成验光数据录入<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"table"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span> <span class="attr">style</span>=<span class="string">"line-height:30px;"</span>&gt;</span>验光数据<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th fourCell"</span> <span class="attr">style</span>=<span class="string">"padding:0;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th twoCell"</span>&gt;</span>足矫光度<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th twoCell"</span>&gt;</span>配镜光度<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr noBottom"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span>&gt;</span>右<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span>&gt;</span>左<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span>&gt;</span>右<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"th"</span>&gt;</span>左<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>球光<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>散光<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>轴位<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>棱镜度<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>矫正视力<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>瞳距<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"tr"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span>下加光<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"td"</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> wepy <span class="keyword">from</span> <span class="string">'wepy'</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">wepy</span>.<span class="title">page</span> </span>&#123;</span></span><br><span class="line">        data = &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-合并表头效果图"><a href="#2-2-合并表头效果图" class="headerlink" title="2.2. 合并表头效果图"></a>2.2. 合并表头效果图</h2><p><img src="../../images/owl/WX20190228-180550@2x.png" alt="截图"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/26/misc/%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81emoji%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/26/misc/%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81emoji%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">微信发送emoji方法</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-26 21:58:29" itemprop="dateCreated datePublished" datetime="2019-02-26T21:58:29+08:00">2019-02-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/misc/" itemprop="url" rel="index">
                    <span itemprop="name">misc</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/26/misc/%E5%BE%AE%E4%BF%A1%E5%8F%91%E9%80%81emoji%E6%96%B9%E6%B3%95/" class="post-meta-item leancloud_visitors" data-flag-title="微信发送emoji方法" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在微信中如果要输入各种表情符号，其实很简单，输入前缀<code>/:</code>然后再加上表情符号的简写即可，表情服务如：</p>
<ul>
<li>笑脸：<code>:)</code></li>
<li>哭脸：<code>:(</code></li>
<li>喝咖啡：<code>coffee</code></li>
<li>吃饭：<code>eat</code></li>
<li>呲牙笑：<code>:D</code></li>
</ul>
<p>所以如果要输入笑脸，输入<code>/::)</code>即可，喝咖啡输入<code>/:coffee</code>即可。</p>
<p>怎么查看 emoji 对应的字符呢，很简单，只要拷贝表情符号，然后黏贴到一些文本编辑器中就可以看到了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/24/myBatis/mybatis%E7%9A%84%E5%88%86%E9%A1%B5PageHelper%E4%BD%95%E6%97%B6%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%B8%8D%E5%AE%89%E5%85%A8%E5%88%86%E9%A1%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/24/myBatis/mybatis%E7%9A%84%E5%88%86%E9%A1%B5PageHelper%E4%BD%95%E6%97%B6%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%B8%8D%E5%AE%89%E5%85%A8%E5%88%86%E9%A1%B5/" class="post-title-link" itemprop="url">mybatis的分页PageHelper何时会导致不安全分页</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-24 20:14:30" itemprop="dateCreated datePublished" datetime="2019-02-24T20:14:30+08:00">2019-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/24/myBatis/mybatis%E7%9A%84%E5%88%86%E9%A1%B5PageHelper%E4%BD%95%E6%97%B6%E4%BC%9A%E5%AF%BC%E8%87%B4%E4%B8%8D%E5%AE%89%E5%85%A8%E5%88%86%E9%A1%B5/" class="post-meta-item leancloud_visitors" data-flag-title="mybatis的分页PageHelper何时会导致不安全分页" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><strong>什么时候会导致不安全的分页？</strong></p>
<p>PageHelper 方法使用了静态的 ThreadLocal 参数，分页参数和线程是绑定的。</p>
<p>只要你可以保证在 PageHelper 方法调用后紧跟 MyBatis 查询方法，这就是安全的。因为 PageHelper 在 finally 代码段中自动清除了 ThreadLocal 存储的对象。</p>
<p>如果代码在进入 Executor 前发生异常，就会导致线程不可用，这属于人为的 Bug（例如接口方法和 XML 中的不匹配，导致找不到 MappedStatement 时）， 这种情况由于线程不可用，也不会导致 ThreadLocal 参数被错误的使用。</p>
<p>但是如果你写出下面这样的代码，就是不安全的用法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">List&lt;Country&gt; list;</span><br><span class="line"><span class="keyword">if</span>(param1 != <span class="keyword">null</span>)&#123;</span><br><span class="line">    list = countryMapper.selectIf(param1);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    list = <span class="keyword">new</span> ArrayList&lt;Country&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种情况下由于 param1 存在 null 的情况，就会导致 PageHelper 生产了一个分页参数，但是没有被消费，这个参数就会一直保留在这个线程上。当这个线程再次被使用时，就可能导致不该分页的方法去消费这个分页参数，这就产生了莫名其妙的分页。</p>
<p>上面这个代码，应该写成下面这个样子：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Country&gt; list;</span><br><span class="line"><span class="keyword">if</span>(param1 != <span class="keyword">null</span>)&#123;</span><br><span class="line">    PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">    list = countryMapper.selectIf(param1);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    list = <span class="keyword">new</span> ArrayList&lt;Country&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这种写法就能保证安全。</p>
<p>如果你对此不放心，你可以手动清理 ThreadLocal 存储的分页参数，可以像下面这样使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Country&gt; list;</span><br><span class="line"><span class="keyword">if</span>(param1 != <span class="keyword">null</span>)&#123;</span><br><span class="line">    PageHelper.startPage(<span class="number">1</span>, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        list = countryMapper.selectAll();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        PageHelper.clearPage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    list = <span class="keyword">new</span> ArrayList&lt;Country&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这么写很不好看，而且没有必要。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/24/owl/owl%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/24/owl/owl%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">owl开发笔记</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-24 19:22:59" itemprop="dateCreated datePublished" datetime="2019-02-24T19:22:59+08:00">2019-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/owl/" itemprop="url" rel="index">
                    <span itemprop="name">owl</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/24/owl/owl%E5%BC%80%E5%8F%91%E7%AC%94%E8%AE%B0/" class="post-meta-item leancloud_visitors" data-flag-title="owl开发笔记" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-vue"><a href="#1-vue" class="headerlink" title="1. vue"></a>1. vue</h1><h2 id="1-1-fontawesome"><a href="#1-1-fontawesome" class="headerlink" title="1.1. fontawesome"></a>1.1. fontawesome</h2><h3 id="1-1-1-package-json-中添加-dependencies-依赖"><a href="#1-1-1-package-json-中添加-dependencies-依赖" class="headerlink" title="1.1.1. package.json 中添加 dependencies 依赖"></a>1.1.1. package.json 中添加 dependencies 依赖</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">        <span class="attr">"font-awesome"</span>: <span class="string">"^4.7.0"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-1-2-main-js-引入样式"><a href="#1-1-2-main-js-引入样式" class="headerlink" title="1.1.2. main.js 引入样式"></a>1.1.2. main.js 引入样式</h3><p>在安装完成 <code>font-awesome</code> npm 包后，在 <code>node_modules</code> 下就可以找到如下的 <code>css</code>，如下图：</p>
<p><img src="/images/owl/WX20190304-202313@2x.png" alt="截图"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'font-awesome/css/font-awesome.min.css'</span></span><br></pre></td></tr></table></figure>

<h3 id="1-1-3-查找-fontawesome-图标"><a href="#1-1-3-查找-fontawesome-图标" class="headerlink" title="1.1.3. 查找 fontawesome 图标"></a>1.1.3. 查找 fontawesome 图标</h3><p><a href="http://www.runoob.com/font-awesome/fontawesome-reference.html" target="_blank" rel="noopener">http://www.runoob.com/font-awesome/fontawesome-reference.html</a></p>
<h3 id="1-1-4-通过-lt-i-gt-图标使用"><a href="#1-1-4-通过-lt-i-gt-图标使用" class="headerlink" title="1.1.4. 通过&lt;i&gt;图标使用"></a>1.1.4. 通过<code>&lt;i&gt;</code>图标使用</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"fa fa-bell-o"</span> @<span class="attr">click</span>=<span class="string">"goChat"</span> <span class="attr">style</span>=<span class="string">"cursor: pointer"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">i</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-if</span>=<span class="string">"user.avatar != ''"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"fa fa-user-circle"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">"font-size: 34px;margin:0 10px;"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>效果图如下：<br><img src="../../images/owl/WX20190304-201439@2x.png" alt="截图"></p>
<h1 id="2-mybatis"><a href="#2-mybatis" class="headerlink" title="2. mybatis"></a>2. mybatis</h1><h2 id="2-1-map-参数传入传出"><a href="#2-1-map-参数传入传出" class="headerlink" title="2.1. map 参数传入传出"></a>2.1. map 参数传入传出</h2><h3 id="2-1-1-map-参数传入"><a href="#2-1-1-map-参数传入" class="headerlink" title="2.1.1. map 参数传入"></a>2.1.1. map 参数传入</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"searchBase"</span>&gt;</span></span><br><span class="line">    from wx_user where 1=1</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"country != null and country != ''"</span>&gt;</span></span><br><span class="line">        and `country` = #&#123;country&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"province != null and province != ''"</span>&gt;</span></span><br><span class="line">        and `province` = #&#123;province&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"city != null and city != ''"</span>&gt;</span></span><br><span class="line">        and `city` = #&#123;city&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"keywords != null and keywords != ''"</span>&gt;</span></span><br><span class="line">        and `nick_name` like "%"#&#123;keywords&#125;"%"</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"searchList"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"searchBase"</span>/&gt;</span></span><br><span class="line">    order by created_at desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-2-返回的-map-键值从字段下划线格式转换为-json-属性驼峰格式"><a href="#2-1-2-返回的-map-键值从字段下划线格式转换为-json-属性驼峰格式" class="headerlink" title="2.1.2. 返回的 map 键值从字段下划线格式转换为 json 属性驼峰格式"></a>2.1.2. 返回的 map 键值从字段下划线格式转换为 json 属性驼峰格式</h3><h4 id="2-1-2-1-定义转换类"><a href="#2-1-2-1-定义转换类" class="headerlink" title="2.1.2.1. 定义转换类"></a>2.1.2.1. 定义转换类</h4><h5 id="2-1-2-1-1-CamelKeyMap-java"><a href="#2-1-2-1-1-CamelKeyMap-java" class="headerlink" title="2.1.2.1.1. CamelKeyMap.java"></a>2.1.2.1.1. CamelKeyMap.java</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.owl.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CamelKeyMap</span> <span class="keyword">extends</span> <span class="title">HashMap</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">put</span><span class="params">(Object key, Object value)</span> </span>&#123;</span><br><span class="line">        key = Utils.underlineToCamelhump(String.valueOf(key));</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2-1-2-1-2-Utils-java"><a href="#2-1-2-1-2-Utils-java" class="headerlink" title="2.1.2.1.2. Utils.java"></a>2.1.2.1.2. Utils.java</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Utils</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将下划线风格替换为驼峰风格</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> inputString</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">underlineToCamelhump</span><span class="params">(String inputString)</span> </span>&#123;</span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> nextUpperCase = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; inputString.length(); i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> c = inputString.charAt(i);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="string">'_'</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (sb.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    nextUpperCase = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (nextUpperCase) &#123;</span><br><span class="line">                    sb.append(Character.toUpperCase(c));</span><br><span class="line">                    nextUpperCase = <span class="keyword">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    sb.append(Character.toLowerCase(c));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sb.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-2-返回类型使用转换类"><a href="#2-1-2-2-返回类型使用转换类" class="headerlink" title="2.1.2.2. 返回类型使用转换类"></a>2.1.2.2. 返回类型使用转换类</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"search"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> <span class="attr">resultType</span>=<span class="string">"com.owl.common.CamelKeyMap"</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"searchBase"</span>/&gt;</span></span><br><span class="line">    order by created_at desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-利用-PageHelper-进行分页"><a href="#2-2-利用-PageHelper-进行分页" class="headerlink" title="2.2. 利用 PageHelper 进行分页"></a>2.2. 利用 PageHelper 进行分页</h2><h3 id="2-2-1-网址"><a href="#2-2-1-网址" class="headerlink" title="2.2.1. 网址"></a>2.2.1. 网址</h3><p><a href="https://pagehelper.github.io/" target="_blank" rel="noopener">https://pagehelper.github.io/</a></p>
<h3 id="2-2-2-pom-xml-引入依赖"><a href="#2-2-2-pom-xml-引入依赖" class="headerlink" title="2.2.2. pom.xml 引入依赖"></a>2.2.2. pom.xml 引入依赖</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--分页支持--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="2-2-3-使用"><a href="#2-2-3-使用" class="headerlink" title="2.2.3. 使用"></a>2.2.3. 使用</h3><h4 id="2-2-3-1-编写-xml"><a href="#2-2-3-1-编写-xml" class="headerlink" title="2.2.3.1. 编写 xml"></a>2.2.3.1. 编写 xml</h4><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"searchList"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"searchBase"</span>/&gt;</span></span><br><span class="line">    order by created_at desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-2-接口文件"><a href="#2-2-3-2-接口文件" class="headerlink" title="2.2.3.2. 接口文件"></a>2.2.3.2. 接口文件</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">WxUserMapper</span> </span>&#123;</span><br><span class="line">    <span class="function">List <span class="title">searchList</span><span class="params">(Map map)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-3-代码中使用"><a href="#2-2-3-3-代码中使用" class="headerlink" title="2.2.3.3. 代码中使用"></a>2.2.3.3. 代码中使用</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/search"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> PageInfo&lt;Map&gt; <span class="title">search</span><span class="params">(@RequestParam Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">    Integer pageNum = Integer.valueOf(map.get(<span class="string">"pageNum"</span>).toString());</span><br><span class="line">    Integer pageSize = Integer.valueOf(map.get(<span class="string">"pageSize"</span>).toString());</span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    List&lt;Map&gt; all = wxUserMapper.search(map);</span><br><span class="line">    PageInfo&lt;Map&gt; result = <span class="keyword">new</span> PageInfo&lt;&gt;(all);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-2-3-4-性能分析"><a href="#2-2-3-4-性能分析" class="headerlink" title="2.2.3.4. 性能分析"></a>2.2.3.4. 性能分析</h4><p>当前页为第一页时，由于没有偏移量，所以 limit 后面只跟了一个数量：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Creating a new SqlSession</span><br><span class="line">SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26d385c7] was not registered <span class="keyword">for</span> synchronization because synchronization is not active</span><br><span class="line">Cache Hit Ratio [SQL_CACHE]: 0.6666666666666666</span><br><span class="line">JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@2fc5a184] will not be managed by Spring</span><br><span class="line">==&gt;  Preparing: select count(0) from (select * from wx_user <span class="built_in">where</span> 1=1 and `country` = ? and `nick_name` like <span class="string">"%"</span>?<span class="string">"%"</span> order by created_at desc) tmp_count</span><br><span class="line">==&gt; Parameters: china(String), 葛(String)</span><br><span class="line">&lt;==    Columns: count(0)</span><br><span class="line">&lt;==        Row: 1</span><br><span class="line">&lt;==      Total: 1</span><br><span class="line">==&gt;  Preparing: select * from wx_user <span class="built_in">where</span> 1=1 and `country` = ? and `nick_name` like <span class="string">"%"</span>?<span class="string">"%"</span> order by created_at desc LIMIT ?</span><br><span class="line">==&gt; Parameters: china(String), 葛(String), 1(Integer)</span><br><span class="line">&lt;==    Columns: id, kind, from_id, from_nick_name, card_no, open_id, nick_name, gender, avatar_url, name, mobile, job, birthday, memo, country, province, city, enabled, created_at, updated_at</span><br><span class="line">&lt;==        Row: 1, 1, null, null, null, oqWDT5NXR0r4BLY-9O5VUoAAeaxc, 葛绍飞, 1, https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLhyJcotR1MeC4zKhgjtKDjaIyWXuia5nLcjy3t9aS1yw6LsN4NEVaFFf40m9gv4DYa45GtkfH6Mwg/132, 葛绍飞, 1859098909, 上班族, 2009-12-10, 北大教授, China, Beijing, Chaoyang, null, 2019-02-27 13:36:24, 2019-02-27 13:36:24</span><br><span class="line">&lt;==      Total: 1</span><br><span class="line">Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@26d385c7]</span><br></pre></td></tr></table></figure>

<p>当为第二页时，有了偏移量，PageHelper 这时候在 limit 的后面添加了偏移量，如：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Creating a new SqlSession</span><br><span class="line">SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3296ec98] was not registered <span class="keyword">for</span> synchronization because synchronization is not active</span><br><span class="line">Cache Hit Ratio [SQL_CACHE]: 0.8181818181818182</span><br><span class="line">JDBC Connection [com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl@2fc5a184] will not be managed by Spring</span><br><span class="line">==&gt;  Preparing: select count(0) from (select * from wx_user <span class="built_in">where</span> 1=1 and `country` = ? and `nick_name` like <span class="string">"%"</span>?<span class="string">"%"</span> order by created_at desc) tmp_count</span><br><span class="line">==&gt; Parameters: china(String), 葛(String)</span><br><span class="line">&lt;==    Columns: count(0)</span><br><span class="line">&lt;==        Row: 2</span><br><span class="line">&lt;==      Total: 1</span><br><span class="line">==&gt;  Preparing: select * from wx_user <span class="built_in">where</span> 1=1 and `country` = ? and `nick_name` like <span class="string">"%"</span>?<span class="string">"%"</span> order by created_at desc LIMIT ?, ?</span><br><span class="line">==&gt; Parameters: china(String), 葛(String), 1(Integer), 1(Integer)</span><br><span class="line">&lt;==    Columns: id, kind, from_id, from_nick_name, card_no, open_id, nick_name, gender, avatar_url, name, mobile, job, birthday, memo, country, province, city, enabled, created_at, updated_at</span><br><span class="line">&lt;==        Row: 1, 1, null, null, null, oqWDT5NXR0r4BLY-9O5VUoAAeaxc, 葛绍飞, 1, https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLhyJcotR1MeC4zKhgjtKDjaIyWXuia5nLcjy3t9aS1yw6LsN4NEVaFFf40m9gv4DYa45GtkfH6Mwg/132, 葛绍飞, 1859098909, 上班族, 2009-12-10, 北大教授, China, Beijing, Chaoyang, null, 2019-02-27 13:36:24, 2019-02-27 13:36:24</span><br><span class="line">&lt;==      Total: 1</span><br><span class="line">Closing non transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@3296ec98]</span><br></pre></td></tr></table></figure>

<p><img src="../../images/owl/WX20190227-210858@2x.png" alt="执行时截图"></p>
<p>其实一开始看到这段代码时候，我觉得应该是内存分页。其实插件对 mybatis 执行流程进行了增强，添加了 limit 以及 count 查询，属于物理分页。</p>
<h3 id="2-2-4-与-在配置文件中的使用"><a href="#2-2-4-与-在配置文件中的使用" class="headerlink" title="2.2.4. #与$在配置文件中的使用"></a>2.2.4. <code>#</code>与<code>$</code>在配置文件中的使用</h3><h4 id="2-2-4-1-区别"><a href="#2-2-4-1-区别" class="headerlink" title="2.2.4.1. 区别"></a>2.2.4.1. 区别</h4><h5 id="2-2-4-1-1-直接求值"><a href="#2-2-4-1-1-直接求值" class="headerlink" title="2.2.4.1.1. $直接求值"></a>2.2.4.1.1. <code>$</code>直接求值</h5><p>适用于不能使用表达式的关键字中，如 order by,limit 等</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"saveField"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span>&gt;</span></span><br><span class="line">    update orders</span><br><span class="line">    set $&#123;field&#125;=#&#123;value&#125;</span><br><span class="line">    where id=#&#123;id&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"searchList"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"searchBase"</span>/&gt;</span></span><br><span class="line">    order by created_at desc</span><br><span class="line">    limit $&#123;skip&#125;,$&#123;size&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"dynamicQuery"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">    select * from $&#123;tableName&#125; order by $&#123;orderCol&#125; desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="2-2-4-1-2-生成占位符"><a href="#2-2-4-1-2-生成占位符" class="headerlink" title="2.2.4.1.2. #生成占位符?"></a>2.2.4.1.2. <code>#</code>生成占位符<code>?</code></h5><p>使用<code>#{}</code>意味着使用的预编译的语句，即在使用 <code>jdbc</code> 时的 preparedStatement，sql 语句中如果存在参数则会使用?作占位符，我们知道这种方式可以防止 sql 注入，并且在使用<code>#{}</code>时形成的 <code>sql</code> 语句，已经带有引号，例，<code>select * from table1 where id=#{id}</code> 在调用这个语句时我们可以通过后台看到打印出的 sql 为：<code>select \* from table1 where id=&#39;2&#39;</code> 加入传的值为 2.也就是说在组成 sql 语句的时候把参数默认为字符串。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectMessageByIdI"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"Message"</span>&gt;</span></span><br><span class="line">    select * from message where id=#&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="2-3-模糊查询"><a href="#2-3-模糊查询" class="headerlink" title="2.3. 模糊查询"></a>2.3. 模糊查询</h2><p>有两种方式，代码如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"optoDataList"</span> <span class="attr">resultType</span>=<span class="string">"com.owl.common.CamelKeyMap"</span>&gt;</span></span><br><span class="line">    select d.id,d.order_no,d.created_at,s.name as shop_name,o.name as opto_name,u.name as</span><br><span class="line">    customer_name,r.the_date_time</span><br><span class="line">    from orders d</span><br><span class="line">    inner join reservation r on r.id = d.reservation_id</span><br><span class="line">    inner join shop s on s.id = d.shop_id</span><br><span class="line">    inner join optometrist o on o.id = d.optometrist_id</span><br><span class="line">    inner join wx_user u on u.id = d.customer_id</span><br><span class="line">    where d.status in (2,3,4)</span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"keywords != null and keywords != ''"</span>&gt;</span></span><br><span class="line">        and (u.name like "%"#&#123;keywords&#125;"%" or o.name like concat('%',#&#123;keywords&#125;,'%'))</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"province != null and province != ''"</span>&gt;</span></span><br><span class="line">        and s.province=#&#123;province&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"city != null and city != ''"</span>&gt;</span></span><br><span class="line">        and s.city=#&#123;city&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"district != null and district != ''"</span>&gt;</span></span><br><span class="line">        and s.district=#&#123;district&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    order by r.the_date_time desc</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="3-spring"><a href="#3-spring" class="headerlink" title="3. spring"></a>3. spring</h1><h2 id="3-1-RestController"><a href="#3-1-RestController" class="headerlink" title="3.1. @RestController"></a>3.1. <code>@RestController</code></h2><h3 id="3-1-1-通过-json-格式提交"><a href="#3-1-1-通过-json-格式提交" class="headerlink" title="3.1.1. 通过 json 格式提交"></a>3.1.1. 通过 <code>json</code> 格式提交</h3><p>通过 <code>@RequestBody</code> 转换为数据对象，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping</span>(<span class="string">"/updateInfo"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateInfo</span><span class="params">(@RequestBody WxUser wxUser2)</span> </span>&#123;</span><br><span class="line">    wxUserService.update(wxUser2);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-2-通过x-www-form-urlencoded"><a href="#3-1-2-通过x-www-form-urlencoded" class="headerlink" title="3.1.2. 通过x-www-form-urlencoded"></a>3.1.2. 通过<code>x-www-form-urlencoded</code></h3><p>直接在形参中就可以获取到，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/add"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addUser</span><span class="params">(User2 user)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> userService.addUser(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-3-获取为-map-参数"><a href="#3-1-3-获取为-map-参数" class="headerlink" title="3.1.3. 获取为 map 参数"></a>3.1.3. 获取为 map 参数</h3><h4 id="3-1-3-1-RequestParam"><a href="#3-1-3-1-RequestParam" class="headerlink" title="3.1.3.1. @RequestParam"></a>3.1.3.1. @RequestParam</h4><p>不管是通过 <code>url 传参</code>，<code>form-data</code>、<code>x-www-form-urlencoded</code> 方式传入，在服务端都需要通过 <code>@RequestParam</code> 方式注解转换为 map 对象，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/search"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> PageInfo&lt;Map&gt; <span class="title">search</span><span class="params">(@RequestParam Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">    Integer pageNum = Integer.valueOf(map.get(<span class="string">"pageNum"</span>).toString());</span><br><span class="line">    Integer pageSize = Integer.valueOf(map.get(<span class="string">"pageSize"</span>).toString());</span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    List&lt;Map&gt; all = wxUserMapper.search(map);</span><br><span class="line">    PageInfo&lt;Map&gt; result = <span class="keyword">new</span> PageInfo&lt;&gt;(all);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3-1-3-2-RequestBody"><a href="#3-1-3-2-RequestBody" class="headerlink" title="3.1.3.2. @RequestBody"></a>3.1.3.2. <code>@RequestBody</code></h4><p>如果客户端是通过 json 方式提交的，则通过 <code>@RequestBody</code> 的方式转为 map 格式，如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PostMapping</span>(<span class="string">"/search"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> PageInfo&lt;Map&gt; <span class="title">search</span><span class="params">(@RequestBody Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">    Integer pageNum = Integer.valueOf(map.get(<span class="string">"pageNum"</span>).toString());</span><br><span class="line">    Integer pageSize = Integer.valueOf(map.get(<span class="string">"pageSize"</span>).toString());</span><br><span class="line">    PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    List&lt;Map&gt; all = wxUserMapper.search(map);</span><br><span class="line">    PageInfo&lt;Map&gt; result = <span class="keyword">new</span> PageInfo&lt;&gt;(all);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="4-wepy"><a href="#4-wepy" class="headerlink" title="4. wepy"></a>4. wepy</h1><h2 id="4-1-props-传值"><a href="#4-1-props-传值" class="headerlink" title="4.1. props 传值"></a>4.1. props 传值</h2><h3 id="4-1-1-静态传值"><a href="#4-1-1-静态传值" class="headerlink" title="4.1.1. 静态传值"></a>4.1.1. 静态传值</h3><p>静态传值只能传递字符串类型，如果在组件中定义了静态传值的属性类型是非字符串类型，都将会传递失败。</p>
<p>子组件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">props = &#123;</span><br><span class="line">    title: &#123;</span><br><span class="line">        type: <span class="built_in">String</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="string">'hi'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    width: &#123;</span><br><span class="line">        type: <span class="built_in">Number</span>,</span><br><span class="line">        <span class="keyword">default</span>: <span class="number">300</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>父组件：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modal</span> <span class="attr">width</span>=<span class="string">"400"</span> <span class="attr">title</span>=<span class="string">"nihao"</span>&gt;</span><span class="tag">&lt;/<span class="name">modal</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面 <code>width</code> 传递失败，<code>width</code> 的值仍未默认值 <code>300</code>，而 <code>title</code> 能够传递成功，其值为 <code>nihao</code>。</p>
<h3 id="4-1-2-动态传值"><a href="#4-1-2-动态传值" class="headerlink" title="4.1.2. 动态传值"></a>4.1.2. 动态传值</h3><h4 id="4-1-2-1-once-传值"><a href="#4-1-2-1-once-传值" class="headerlink" title="4.1.2.1. once 传值"></a>4.1.2.1. once 传值</h4><p>需要在属性前面添加<code>:</code>，然后通过定义的变量传入，如果父组件改变了变量的值，并不会更新到子组件，除非显示调用<code>this.$apply()</code>，参见下面的示例。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modal</span> <span class="attr">:width</span>=<span class="string">"width"</span> <span class="attr">:visible.sync</span>=<span class="string">"visible"</span> <span class="attr">title</span>=<span class="string">"nihao"</span>&gt;</span><span class="tag">&lt;/<span class="name">modal</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// ....</span></span></span><br><span class="line">    props = &#123;</span><br><span class="line">        title: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">String</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>: <span class="string">'hi'</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        visable: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">Boolean</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">            twoway: <span class="literal">true</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        width: &#123;</span><br><span class="line"><span class="javascript">            type: <span class="built_in">Number</span>,</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">default</span>: <span class="number">300</span></span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="actionscript">    <span class="comment">// ...</span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="4-1-2-2-动态更新"><a href="#4-1-2-2-动态更新" class="headerlink" title="4.1.2.2. 动态更新"></a>4.1.2.2. 动态更新</h4><p>动态更新指的是如果父组件的属性发生了更改，同时也会更改子组件属性，需要在后面再添加<code>.sync</code>修饰符。参见上面示例。</p>
<h4 id="4-1-2-3-逆向传值"><a href="#4-1-2-3-逆向传值" class="headerlink" title="4.1.2.3. 逆向传值"></a>4.1.2.3. 逆向传值</h4><p>如果要实现子组件更改了属性的值，同时通知到父组件，需要在子组件中定义属性<code>twoway:true</code>，参见上面示例。</p>
<h2 id="4-2-组件"><a href="#4-2-组件" class="headerlink" title="4.2. 组件"></a>4.2. 组件</h2><p>定义一个组件时，需要在 template 下面新增一个包裹节点，在父组件中的属性将会附加在节点上。</p>
<h3 id="4-2-1-子组件定义"><a href="#4-2-1-子组件定义" class="headerlink" title="4.2.1. 子组件定义"></a>4.2.1. 子组件定义</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"modalBg"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">"opacity:&#123;&#123;opacity&#125;&#125;;"</span></span></span><br><span class="line"><span class="tag">  &gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"modalBox"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">"top:&#123;&#123;top&#125;&#125;px;left:&#123;&#123;left&#125;&#125;px;width:&#123;&#123;width&#125;&#125;px;height:&#123;&#123;height&#125;&#125;px;"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"head"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"foot"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-2-父组件调用"><a href="#4-2-2-父组件调用" class="headerlink" title="4.2.2. 父组件调用"></a>4.2.2. 父组件调用</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">modal</span></span></span><br><span class="line"><span class="tag">  <span class="attr">width</span>=<span class="string">"210"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">height</span>=<span class="string">"250"</span></span></span><br><span class="line"><span class="tag">  <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;visable&#125;&#125;"</span> <span class="attr">x</span>=<span class="string">"ss"</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"qr"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">src</span>=<span class="string">"https://csdnimg.cn/pubfooter/images/csdn_cs_qr.png"</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">"btn"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">slot</span>=<span class="string">"foot"</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">tap</span>=<span class="string">"close"</span></span></span><br><span class="line"><span class="tag">  &gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">modal</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-3-最后生成的-xml"><a href="#4-2-3-最后生成的-xml" class="headerlink" title="4.2.3. 最后生成的 xml"></a>4.2.3. 最后生成的 xml</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"modalBg _57d24c4 _a61e190"</span> <span class="attr">style</span>=<span class="string">"opacity:&#123;&#123;$modal$opacity&#125;&#125;;"</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;visable&#125;&#125;"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"modalBox _57d24c4"</span> <span class="attr">style</span>=<span class="string">"top:&#123;&#123;$modal$top&#125;&#125;px;left:&#123;&#123;$modal$left&#125;&#125;px;width:&#123;&#123;$modal$width&#125;&#125;px;height:&#123;&#123;$modal$height&#125;&#125;px;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">"qr _a61e190"</span> <span class="attr">src</span>=<span class="string">"https://csdnimg.cn/pubfooter/images/csdn_cs_qr.png"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn _a61e190"</span> <span class="attr">bindtap</span>=<span class="string">"close"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="4-2-4-分析"><a href="#4-2-4-分析" class="headerlink" title="4.2.4. 分析"></a>4.2.4. 分析</h3><p>最后的 opacity 落在了第一个 view 节点上面，并不能够启动控制整个子组件显示与否，正确的做法是在子组件里套一个 block 节点，如：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">block</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"modalBg"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"opacity:&#123;&#123;opacity&#125;&#125;;"</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">"modalBox"</span></span></span><br><span class="line"><span class="tag">      <span class="attr">style</span>=<span class="string">"top:&#123;&#123;top&#125;&#125;px;left:&#123;&#123;left&#125;&#125;px;width:&#123;&#123;width&#125;&#125;px;height:&#123;&#123;height&#125;&#125;px;"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"head"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"foot"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>生成的 xml 如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">block</span> <span class="attr">class</span>=<span class="string">"_57d24c4 _a61e190"</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;visable&#125;&#125;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"modalBg _57d24c4"</span> <span class="attr">style</span>=<span class="string">"opacity:&#123;&#123;$modal$opacity&#125;&#125;;"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"modalBox _57d24c4"</span> <span class="attr">style</span>=<span class="string">"top:&#123;&#123;$modal$top&#125;&#125;px;left:&#123;&#123;$modal$left&#125;&#125;px;width:&#123;&#123;$modal$width&#125;&#125;px;height:&#123;&#123;$modal$height&#125;&#125;px;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">"qr _a61e190"</span> <span class="attr">src</span>=<span class="string">"https://csdnimg.cn/pubfooter/images/csdn_cs_qr.png"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn _a61e190"</span> <span class="attr">bindtap</span>=<span class="string">"close"</span>&gt;</span>关闭<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">block</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="5-css"><a href="#5-css" class="headerlink" title="5. css"></a>5. css</h1><h2 id="5-1-flex"><a href="#5-1-flex" class="headerlink" title="5.1. flex"></a>5.1. flex</h2><h3 id="5-1-1-容器属性摘要"><a href="#5-1-1-容器属性摘要" class="headerlink" title="5.1.1. 容器属性摘要"></a>5.1.1. 容器属性摘要</h3><ul>
<li>设为 Flex 布局以后，子元素的 float、clear 和 vertical-align 属性将失效。</li>
<li>flex-flow 属性是 flex-direction 属性和 flex-wrap 属性的简写形式，默认值为 row nowrap。</li>
<li>align-items 属性定义项目在交叉轴上如何对齐，stretch 是其默认值，如果项目未设置高度或设为 auto，将占满整个容器的高度。</li>
<li>align-content 属性定义了多根轴线的对齐方式。如果项目只有一根轴线，该属性不起作用。</li>
</ul>
<h3 id="5-1-2-项目属性摘要"><a href="#5-1-2-项目属性摘要" class="headerlink" title="5.1.2. 项目属性摘要"></a>5.1.2. 项目属性摘要</h3><ul>
<li>order 属性定义项目的排列顺序。数值越小，排列越靠前，默认为 0。</li>
<li>flex-grow 属性定义项目的放大比例，默认为 0，即如果存在剩余空间，也不放大。</li>
<li>flex-shrink 属性定义了项目的缩小比例，默认为 1，即如果空间不足，该项目将缩小。如果所有项目的 flex-shrink 属性都为 1，当空间不足时，都将等比例缩小。如果一个项目的 flex-shrink 属性为 0，其他项目都为 1，则空间不足时，前者不缩小。</li>
<li>flex-basis 属性定义了在分配多余空间之前，项目占据的主轴空间（main size）。浏览器根据这个属性，计算主轴是否有多余空间。它的默认值为 auto，即项目的本来大小。</li>
<li>flex 属性是 flex-grow, flex-shrink 和 flex-basis 的简写，默认值为 0 1 auto。后两个属性可选。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/24/myBatis/mybatis%E4%B8%AD%E4%BA%95%E5%8F%B7%E5%92%8C%E7%BE%8E%E5%85%83%E7%AC%A6%E5%8F%B7%E7%9A%84%E5%8C%BA%E5%88%AB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/24/myBatis/mybatis%E4%B8%AD%E4%BA%95%E5%8F%B7%E5%92%8C%E7%BE%8E%E5%85%83%E7%AC%A6%E5%8F%B7%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-title-link" itemprop="url">mybatis中#和$符号的区别</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-24 10:41:26" itemprop="dateCreated datePublished" datetime="2019-02-24T10:41:26+08:00">2019-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/24/myBatis/mybatis%E4%B8%AD%E4%BA%95%E5%8F%B7%E5%92%8C%E7%BE%8E%E5%85%83%E7%AC%A6%E5%8F%B7%E7%9A%84%E5%8C%BA%E5%88%AB/" class="post-meta-item leancloud_visitors" data-flag-title="mybatis中#和$符号的区别" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id=""><a href="#" class="headerlink" title="#{}"></a><code>#{}</code></h1><p>使用<code>#{}</code>意味着使用的预编译的语句，即在使用 jdbc 时的 preparedStatement，sql 语句中如果存在参数则会使用?作占位符，我们知道这种方式可以防止 sql 注入，并且在使用<code>#{}</code>时形成的 sql 语句，已经带有引号，例，<code>select * from table1 where id=#{id}</code> 在调用这个语句时我们可以通过后台看到打印出的 sql 为：<code>select * from table1 where id=&#39;2&#39;</code> 加入传的值为 2.也就是说在组成 sql 语句的时候把参数默认为字符串。</p>
<h1 id="-1"><a href="#-1" class="headerlink" title="${}"></a><code>${}</code></h1><p>使用<code>${}</code>时的 sql 不会当做字符串处理，是什么就是什么，如上边的语句：<code>select * from table1 where id=${id}</code> 在调用这个语句时控制台打印的为：<code>select * from table1 where id=2</code> ，假设传的参数值为 2</p>
<p>从上边的介绍可以看出这两种方式的区别，我们最好是能用<code>#{}</code>则用它，因为它可以防止 sql 注入，且是预编译的，在需要原样输出时才使用<code>${}</code>，如，</p>
<p><code>select * from ${tableName} order by ${id}</code> 这里需要传入表名和按照哪个列进行排序 ，加入传入 table1、id 则语句为：<code>select * from table1 order by id</code></p>
<p>如果是使用<code>#{}</code> 则变成了 <code>select * from &#39;table1&#39; order by &#39;id&#39;</code> 我们知道这样就不对了。</p>
<p>另，在使用以下的配置时，必须使用<code>#{}</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectMessageByIdI"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"Message"</span>&gt;</span></span><br><span class="line">    select * from message where id=#&#123;id&#125;;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>同样由于 limit 后面不支持表达式和字符串，也是必须要采用<code>${}</code>的方式。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"searchList"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">    select *</span><br><span class="line">    <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"searchBase"</span>/&gt;</span></span><br><span class="line">    order by created_at desc</span><br><span class="line">    limit $&#123;pageNum&#125;,$&#123;pageSizew&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在 parameterType 是 int 时，sql 语句中必须是<code>#{}</code>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/24/webstorm/%E5%8E%BB%E6%8E%89IntelliJ-IDEA%E4%B8%ADmybatis%E5%AF%B9%E5%BA%94%E7%9A%84xml%E6%96%87%E4%BB%B6%E8%AD%A6%E5%91%8A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/24/webstorm/%E5%8E%BB%E6%8E%89IntelliJ-IDEA%E4%B8%ADmybatis%E5%AF%B9%E5%BA%94%E7%9A%84xml%E6%96%87%E4%BB%B6%E8%AD%A6%E5%91%8A/" class="post-title-link" itemprop="url">去掉IntelliJ IDEA 中 mybatis 对应的 xml 文件警告</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-24 08:56:05" itemprop="dateCreated datePublished" datetime="2019-02-24T08:56:05+08:00">2019-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/idea/" itemprop="url" rel="index">
                    <span itemprop="name">idea</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/24/webstorm/%E5%8E%BB%E6%8E%89IntelliJ-IDEA%E4%B8%ADmybatis%E5%AF%B9%E5%BA%94%E7%9A%84xml%E6%96%87%E4%BB%B6%E8%AD%A6%E5%91%8A/" class="post-meta-item leancloud_visitors" data-flag-title="去掉IntelliJ IDEA 中 mybatis 对应的 xml 文件警告" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>IntelliJ IDEA 打开 mybatis 的 xml 文件时，对应的 xml 文件中 sql 语句背景色总是有黄色或绿色的背景色。</p>
<p><img src="/images/owl/20170330110932036.jpg" alt="这里写图片描述"></p>
<p>提示（红圈处）上已经说明，需要配置在 IDEA 中配置 <code>data source</code> （通常我们很少使用 IDE 去查看数据库内容，而是使用其他专门的 DB 工具）。</p>
<hr>
<h1 id="去掉-No-data-sources-configure-警告"><a href="#去掉-No-data-sources-configure-警告" class="headerlink" title="去掉 No data sources configure 警告"></a>去掉 No data sources configure 警告</h1><blockquote>
<p>当然，如果你选择配置 <code>data source</code> 也可以，纯属个人习惯）</p>
</blockquote>
<ul>
<li>Prefernces ⇒ Editor ⇒ Inspections ⇒ SQL ⇒ No data sources configure。</li>
<li>取消勾选，去掉这个检查，然后点击 <code>OK</code> 按钮即可。</li>
</ul>
<p><img src="../../images/owl/20170330111504491.jpg" alt="这里写图片描述"></p>
<p>此时仍有警告，不过警告信息变了，如图中红圈所示</p>
<p><img src="../../images/owl/20170330113004901.png" alt="这里写图片描述"></p>
<hr>
<h1 id="去掉-SQL-dialect-is-not-configured-警告"><a href="#去掉-SQL-dialect-is-not-configured-警告" class="headerlink" title="去掉 SQL dialect is not configured 警告"></a>去掉 SQL dialect is not configured 警告</h1><ul>
<li>Prefernces ⇒ Editor ⇒ Inspections ⇒ SQL ⇒ SQL dialect detection。</li>
<li>取消勾选，去掉这个检查，然后点击 <code>OK</code> 按钮即可。</li>
</ul>
<p><img src="../../images/owl/20170330113324984.jpg" alt="这里写图片描述"></p>
<p>此时仍有绿色的背景色</p>
<p><img src="../../images/owl/20170330115709971.png" alt="这里写图片描述"></p>
<hr>
<h1 id="去掉“注入语言”的背景色"><a href="#去掉“注入语言”的背景色" class="headerlink" title="去掉“注入语言”的背景色"></a>去掉“注入语言”的背景色</h1><ul>
<li>Prefernces ⇒ Editor ⇒ Colors &amp; Fonts ⇒ General ⇒ Code ⇒ Injected language fragment ⇒ Background。</li>
<li>取消勾选，然后点击 <code>OK</code> 按钮即可。</li>
</ul>
<p><img src="../../images/owl/20170330115407952.png" alt="这里写图片描述"></p>
<p>2019.3 的版本如下：</p>
<p><img src="../../images/pasteImage/2020-03-30-12-04-04.png" alt=""></p>
<hr>
<p>世界清净了！！！<br>世界清净了！！！<br>世界清净了！！！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/24/myBatis/Mybatis%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/24/myBatis/Mybatis%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">Mybatis传递参数的三种方式</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-24 07:11:53" itemprop="dateCreated datePublished" datetime="2019-02-24T07:11:53+08:00">2019-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/24/myBatis/Mybatis%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" class="post-meta-item leancloud_visitors" data-flag-title="Mybatis传递参数的三种方式" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h1><h2 id="Dao-层使用-Param-注解的方法"><a href="#Dao-层使用-Param-注解的方法" class="headerlink" title="Dao 层使用@Param 注解的方法"></a>Dao 层使用@Param 注解的方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">VersionBox <span class="title">getVersionByVersionNumAndVersionType</span><span class="params">(@Param(<span class="string">"versionNum"</span>)</span> String versionNum, @<span class="title">Param</span><span class="params">(<span class="string">"versionType"</span>)</span> String versionType)</span>;</span><br></pre></td></tr></table></figure>

<h2 id="对应的-Mapper-xml"><a href="#对应的-Mapper-xml" class="headerlink" title="对应的 Mapper.xml"></a>对应的 Mapper.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"Base_Column_List"</span> &gt;</span></span><br><span class="line">   UUID, VERSION_NUM, VERSION_TYPE, VARSION_DESC, CREATE_TIME, CREATE_BY, UPDATE_TIME,</span><br><span class="line">   UPDATE_BY</span><br><span class="line"> <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"></span><br><span class="line"> <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getVersionByVersionNumAndVersionType"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span> &gt;</span></span><br><span class="line">   select</span><br><span class="line">   <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span> /&gt;</span></span><br><span class="line">   from VERSION_BOX</span><br><span class="line">   where VERSION_NUM = #&#123;versionNum,jdbcType=VARCHAR&#125;</span><br><span class="line">   and VERSION_TYPE = #&#123;versionType,jdbcType=VARCHAR&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h1><h2 id="Dao-层采用-Map-传多参数的方法"><a href="#Dao-层采用-Map-传多参数的方法" class="headerlink" title="Dao 层采用 Map 传多参数的方法"></a>Dao 层采用 Map 传多参数的方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">selectBeaconTotalCount</span><span class="params">(Map paramMap)</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="Mapper-xml"><a href="#Mapper-xml" class="headerlink" title="Mapper.xml"></a>Mapper.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.joysuch.facade.device.Ibeacon"</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"UUID"</span> <span class="attr">property</span>=<span class="string">"uuid"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"USER_ID"</span> <span class="attr">property</span>=<span class="string">"userId"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"DEVICE_MAC"</span> <span class="attr">property</span>=<span class="string">"deviceMac"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"DEVICE_ID"</span> <span class="attr">property</span>=<span class="string">"deviceId"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"DEVICE_UUID"</span> <span class="attr">property</span>=<span class="string">"deviceUuid"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"DEVICE_TYPE"</span> <span class="attr">property</span>=<span class="string">"deviceType"</span> <span class="attr">jdbcType</span>=<span class="string">"VARCHAR"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"MAJOR"</span> <span class="attr">property</span>=<span class="string">"major"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"MINOR"</span> <span class="attr">property</span>=<span class="string">"minor"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> /&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"NEAR_RSSI"</span> <span class="attr">property</span>=<span class="string">"nearRssi"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectBeaconTotalCount"</span> <span class="attr">resultType</span>=<span class="string">"int"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span> &gt;</span></span><br><span class="line">   select COUNT(UUID)</span><br><span class="line">   from IBEACON</span><br><span class="line">   where BUILDING_ID = #&#123;buildingId,jdbcType=VARCHAR&#125; and DEVICE_TYPE = 'ibeacon'</span><br><span class="line">   <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"deviceMac != null and deviceMac != ''"</span> &gt;</span></span><br><span class="line">     and DEVICE_MAC = #&#123;deviceMac,jdbcType=VARCHAR&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"major != null"</span> &gt;</span></span><br><span class="line">     and MAJOR = #&#123;major,jdbcType=INTEGER&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"minor != null"</span> &gt;</span></span><br><span class="line">     and MINOR = #&#123;minor,jdbcType=INTEGER&#125;</span><br><span class="line">   <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="第三种"><a href="#第三种" class="headerlink" title="第三种"></a>第三种</h2><h2 id="Dao-层根据参数位置下标的方法"><a href="#Dao-层根据参数位置下标的方法" class="headerlink" title="Dao 层根据参数位置下标的方法"></a>Dao 层根据参数位置下标的方法</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">VersionBox <span class="title">getVersionByVersionNumAndVersionType</span><span class="params">(String versionNum, String versionType)</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="对应-Mapper-xml"><a href="#对应-Mapper-xml" class="headerlink" title="对应 Mapper.xml"></a>对应 Mapper.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getVersionByVersionNumAndVersionType"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span> &gt;</span></span><br><span class="line">   select</span><br><span class="line">   <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span> /&gt;</span></span><br><span class="line">   from VERSION_BOX</span><br><span class="line">   where VERSION_NUM = #&#123;0&#125;</span><br><span class="line">   and VERSION_TYPE = #&#123;1&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://swiftist.cn/2019/02/24/myBatis/Mybatis%E5%B8%B8%E7%94%A8%E6%80%BB%E7%BB%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Andy Ge">
      <meta itemprop="description" content="勇于积极进取，步入人生的世外桃源">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="飞雪轩辕">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/02/24/myBatis/Mybatis%E5%B8%B8%E7%94%A8%E6%80%BB%E7%BB%93/" class="post-title-link" itemprop="url">Mybatis常用总结：参数，返回，执行sql，include等</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-02-24 07:04:10" itemprop="dateCreated datePublished" datetime="2019-02-24T07:04:10+08:00">2019-02-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-03-31 23:07:39" itemprop="dateModified" datetime="2020-03-31T23:07:39+08:00">2020-03-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mybatis/" itemprop="url" rel="index">
                    <span itemprop="name">mybatis</span>
                  </a>
                </span>
            </span>

          
            <span id="/2019/02/24/myBatis/Mybatis%E5%B8%B8%E7%94%A8%E6%80%BB%E7%BB%93/" class="post-meta-item leancloud_visitors" data-flag-title="Mybatis常用总结：参数，返回，执行sql，include等" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="1-参数注入"><a href="#1-参数注入" class="headerlink" title="1. 参数注入"></a>1. 参数注入</h1><h2 id="1-1-用-0-1-的形式，0-代表第一个参数，1-代表第二个参数"><a href="#1-1-用-0-1-的形式，0-代表第一个参数，1-代表第二个参数" class="headerlink" title="1.1. 用#{0},#{1}的形式，0 代表第一个参数，1 代表第二个参数"></a>1.1. 用#{0},#{1}的形式，0 代表第一个参数，1 代表第二个参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="function"><span class="keyword">public</span> List&lt;RecordVo&gt; <span class="title">queryList</span><span class="params">(String workerId, Integer topNum)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryList"</span> <span class="attr">resultType</span>=<span class="string">"com.demo.RecordVo"</span>&gt;</span></span><br><span class="line">　　　　SELECT ID id, WORKER_ID workerId, UPDATE_DATE updateDate</span><br><span class="line">　　　　FROM USER_RECORDS t</span><br><span class="line">　　　　WHERE t.WORKER_ID = #&#123;0&#125;</span><br><span class="line">　　　　LIMIT #&#123;1&#125;</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-Map-或者封装对象-workerId-为-map-里面的键；如果是对象则-workerId-为对象中的属性，这种方法非常常用"><a href="#1-2-Map-或者封装对象-workerId-为-map-里面的键；如果是对象则-workerId-为对象中的属性，这种方法非常常用" class="headerlink" title="1.2. Map 或者封装对象,workerId 为 map 里面的键；如果是对象则 workerId 为对象中的属性，这种方法非常常用"></a>1.2. Map 或者封装对象,workerId 为 map 里面的键；如果是对象则 workerId 为对象中的属性，这种方法非常常用</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="function"><span class="keyword">public</span> Integer <span class="title">queryCountByWorkerId</span><span class="params">(Map queryParam)</span></span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryCountByWorkerId"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">　　　　SELECT COUNT(1)</span><br><span class="line">　　　　FROM tableName F</span><br><span class="line">　　　　WHERE F.WORKER_ID = #&#123;workerId&#125;</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-3-注解"><a href="#1-3-注解" class="headerlink" title="1.3. 注解"></a>1.3. 注解</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="function"><span class="keyword">public</span> Integer <span class="title">queryCountByWorkerId</span><span class="params">(@param(“workerId”)</span>String workerId)</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryCountByWorkerId"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">　　　　SELECT COUNT(1)</span><br><span class="line">　　　　FROM tableName F</span><br><span class="line">　　　　WHERE F.WORKER_ID = #&#123;workerId&#125;</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="2-返回"><a href="#2-返回" class="headerlink" title="2. 返回"></a>2. 返回</h1><h2 id="2-1-映射"><a href="#2-1-映射" class="headerlink" title="2.1. 映射"></a>2.1. 映射<!-- 实体类与表字段对应 --></h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"com.demo.DataModule"</span> <span class="attr">id</span>=<span class="string">"dataModule"</span>&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"ID"</span> <span class="attr">property</span>=<span class="string">"id"</span> /&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"CREATE_DATE"</span> <span class="attr">property</span>=<span class="string">"createDate"</span> /&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"WORKERID"</span> <span class="attr">property</span>=<span class="string">"workerId"</span> /&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"UPDATE_DATE"</span> <span class="attr">property</span>=<span class="string">"updateDate"</span> /&gt;</span></span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"STATUS"</span> <span class="attr">property</span>=<span class="string">"status"</span> /&gt;</span></span><br><span class="line">　　<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryAll"</span> <span class="attr">resultType</span>=<span class="string">"dataModule"</span>&gt;</span></span><br><span class="line">　　　　select ID,CREATE_DATE,WORKERID from tableName</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这种方式查询语句查询的字段直接就是数据库里面的字段就好了，就定义映射的 column</p>
<h2 id="2-2-直接返回对象"><a href="#2-2-直接返回对象" class="headerlink" title="2.2. 直接返回对象"></a>2.2. 直接返回对象</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryAll"</span> <span class="attr">resultType</span>=<span class="string">"com.demo.DataModule"</span>&gt;</span></span><br><span class="line">　　　　select ID id,CREATE_DATE createDate,WORKERID workerId from tableName</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里查询返回的字段别名必须对应返回对象中的属性</p>
<h1 id="3-执行原生-sql"><a href="#3-执行原生-sql" class="headerlink" title="3. 执行原生 sql"></a>3. 执行原生 sql</h1><h2 id="3-1-sql-参数"><a href="#3-1-sql-参数" class="headerlink" title="3.1. sql 参数"></a>3.1. sql 参数</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ParamVo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">　　　　<span class="keyword">private</span> String sql;</span><br><span class="line">　　　　<span class="comment">//getter setter 省略</span></span><br><span class="line"></span><br><span class="line">　　&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-2-接口"><a href="#3-2-接口" class="headerlink" title="3.2. 接口"></a>3.2. 接口</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="comment">/**</span></span><br><span class="line"><span class="comment">　　* @功能描述: 创建</span></span><br><span class="line"><span class="comment">　　* <span class="doctag">@param</span> vo</span></span><br><span class="line"><span class="comment">　　* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">　　*/</span></span><br><span class="line">　　<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">excuteCreateSql</span><span class="params">(ParamVo vo)</span></span>;</span><br><span class="line"></span><br><span class="line">　　<span class="comment">/**</span></span><br><span class="line"><span class="comment">　　* @功能描述: 查询</span></span><br><span class="line"><span class="comment">　　* <span class="doctag">@param</span> vo</span></span><br><span class="line"><span class="comment">　　* <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">　　*/</span></span><br><span class="line">　　<span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; excuteSelectSql(ParamVo vo);</span><br></pre></td></tr></table></figure>

<h2 id="3-3-xml"><a href="#3-3-xml" class="headerlink" title="3.3. xml"></a>3.3. xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"excuteCreateSql"</span>&gt;</span></span><br><span class="line">　　　　$&#123;sql&#125;</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>${}</code>不编译 sql 直接执行，如果用#{sql}可能报错</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"excuteSelectSql"</span> <span class="attr">resultType</span>=<span class="string">"java.util.Map"</span>&gt;</span></span><br><span class="line">　　　　$&#123;sql&#125;</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里不知道返回类型用 map 或者 hashmap 作为返回</p>
<h1 id="4-include"><a href="#4-include" class="headerlink" title="4. include"></a>4. include</h1><p>有时候两个方法要返回的字段都一样或者 where 子句一样，这样为了避免重复写代码，就抽出来用 include</p>
<h2 id="4-1-定义子句相同部分"><a href="#4-1-定义子句相同部分" class="headerlink" title="4.1. 定义子句相同部分"></a>4.1. 定义子句相同部分</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">　<span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"queryChild"</span>&gt;</span></span><br><span class="line">　　　　FROM tableName1 F</span><br><span class="line">　　　　RIGHT JOIN tableName2 C ON F.WORKER_ID = C.WORKER_ID</span><br><span class="line">　　　　WHERE F.STATUS = 1 AND F.WORKER_ID = #&#123;workerId&#125;</span><br><span class="line">　　　　ORDER BY C.CREATE_DATE DESC</span><br><span class="line">　　<span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="4-2-引用"><a href="#4-2-引用" class="headerlink" title="4.2. 引用"></a>4.2. 引用</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryCountByWorkerId"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></span><br><span class="line">　　　　SELECT COUNT(1)</span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"queryChild"</span>/&gt;</span></span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">　　<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryListByWorkerId"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.Map"</span> <span class="attr">resultType</span>=<span class="string">"com.demo.RecordVo"</span>&gt;</span></span><br><span class="line">　　　　SELECT ID id, WORKER_ID workerId, UPDATE_DATE updateDate,......</span><br><span class="line">　　　　<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"queryChild"</span>/&gt;</span></span><br><span class="line">　　<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/39/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/39/">39</a><span class="page-number current">40</span><a class="page-number" href="/page/41/">41</a><span class="space">&hellip;</span><a class="page-number" href="/page/73/">73</a><a class="extend next" rel="next" href="/page/41/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Andy Ge</p>
  <div class="site-description" itemprop="description">勇于积极进取，步入人生的世外桃源</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">728</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">134</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">315</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/andyge" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;andyge" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:geshaofei@126.com" title="E-Mail → mailto:geshaofei@126.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://www.ruanyifeng.com/" title="http:&#x2F;&#x2F;www.ruanyifeng.com&#x2F;" rel="noopener" target="_blank">阮一峰</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="http://colobu.com/" title="http:&#x2F;&#x2F;colobu.com&#x2F;" rel="noopener" target="_blank">鸟窝</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/hellokuangshen/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;hellokuangshen&#x2F;" rel="noopener" target="_blank">狂神</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://yelog.org/" title="https:&#x2F;&#x2F;yelog.org&#x2F;" rel="noopener" target="_blank">叶落阁</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Andy Ge</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> v7.7.1
  </div>

        






  <script>
  function leancloudSelector(url) {
    url = encodeURI(url);
    return document.getElementById(url).querySelector('.leancloud-visitors-count');
  }
  if (CONFIG.page.isPost) {
    function addCount(Counter) {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.getAttribute('id'));
      var title = visitors.getAttribute('data-flag-title');

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length > 0) {
            var counter = results[0];
            Counter('put', '/classes/Counter/' + counter.objectId, { time: { '__op': 'Increment', 'amount': 1 } })
              .then(response => response.json())
              .then(() => {
                leancloudSelector(url).innerText = counter.time + 1;
              })
              .catch(error => {
                console.error('Failed to save visitor count', error);
              })
          } else {
              Counter('post', '/classes/Counter', { title: title, url: url, time: 1 })
                .then(response => response.json())
                .then(() => {
                  leancloudSelector(url).innerText = 1;
                })
                .catch(error => {
                  console.error('Failed to create', error);
                });
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  } else {
    function showTime(Counter) {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element => {
        return decodeURI(element.getAttribute('id'));
      });

      Counter('get', `/classes/Counter?where=${JSON.stringify({ url: { '$in': entries } })}`)
        .then(response => response.json())
        .then(({ results }) => {
          if (results.length === 0) {
            document.querySelectorAll('.leancloud_visitors .leancloud-visitors-count').forEach(element => {
              element.innerText = 0;
            });
            return;
          }
          for (let item of results) {
            let { url, time } = item;
            leancloudSelector(url).innerText = time;
          }
          for (let url of entries) {
            var element = leancloudSelector(url);
            if (element.innerText == '') {
              element.innerText = 0;
            }
          }
        })
        .catch(error => {
          console.error('LeanCloud Counter Error', error);
        });
    }
  }

  fetch('https://app-router.leancloud.cn/2/route?appId=2TdIb5gRlAVUw24l2W0zWnCj-gzGzoHsz')
    .then(response => response.json())
    .then(({ api_server }) => {
      var Counter = (method, url, data) => {
        return fetch(`https://${api_server}/1.1${url}`, {
          method: method,
          headers: {
            'X-LC-Id'     : '2TdIb5gRlAVUw24l2W0zWnCj-gzGzoHsz',
            'X-LC-Key'    : 'cJdJrMLBXsj0ttq0WsL0aA2j',
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost) {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      } else if (document.querySelectorAll('.post-title-link').length >= 1) {
        showTime(Counter);
      }
    });
  </script>


      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
